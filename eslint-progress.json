[{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\server\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\server\\routes\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\server\\routes\\karaoke.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\AudioVisualizer.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3176,3179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3176,3179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\CollaborativeSession.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nA:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\CollaborativeSession.tsx:126:37\n  124 |\n  125 |   // Calculate current time once per render to avoid purity violations\n> 126 |   const currentTime = useMemo(() => Date.now(), [messages.length]);\n      |                                     ^^^^^^^^^^ Cannot call impure function\n  127 |\n  128 |   const formatTime = (timestamp: number) => {\n  129 |     const diff = currentTime - timestamp;","line":126,"column":37,"nodeType":null,"endLine":126,"endColumn":47},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'messages.length'. Either exclude it or remove the dependency array.","line":126,"column":49,"nodeType":"ArrayExpression","endLine":126,"endColumn":66,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[3824,3841],"text":"[]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\nimport { Users, Globe, Mic, Video, MessageCircle, UserPlus, Crown, MicOff, VideoOff, Copy } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Avatar, AvatarImage, AvatarFallback } from './ui/avatar';\nimport { useAuth } from '../contexts/AuthContext';\nimport { toast } from './ui/toast';\nimport { Switch } from './ui/switch';\n\ninterface Participant {\n  id: string;\n  name: string;\n  avatar?: string;\n  isHost: boolean;\n  isMuted: boolean;\n  hasVideo: boolean;\n  isCurrentUser?: boolean;\n}\n\nexport function CollaborativeSession() {\n  const { user } = useAuth();\n  const [participants, setParticipants] = useState<Participant[]>([\n    {\n      id: user?.id || '1',\n      name: user?.name || 'You',\n      avatar: user?.avatar,\n      isHost: true,\n      isMuted: false,\n      hasVideo: true,\n      isCurrentUser: true\n    },\n    {\n      id: '2',\n      name: 'Sarah Johnson',\n      avatar: 'https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg?auto=compress&cs=tinysrgb&w=64&h=64&fit=crop',\n      isHost: false,\n      isMuted: true,\n      hasVideo: true\n    },\n    {\n      id: '3',\n      name: 'Mike Chen',\n      avatar: 'https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=64&h=64&fit=crop',\n      isHost: false,\n      isMuted: false,\n      hasVideo: false\n    }\n  ]);\n\n  const [messages, setMessages] = useState(() => {\n    const now = Date.now();\n    return [\n      { id: '1', user: 'Sarah Johnson', message: 'Â¡Excelente canciÃ³n! ðŸŽ¤', timestamp: now - 30000 },\n      { id: '2', user: 'Mike Chen', message: 'Me encanta esta colaboraciÃ³n', timestamp: now - 15000 },\n      { id: '3', user: 'System', message: 'Recording started - everyone ready?', timestamp: now - 5000 }\n    ];\n  });\n\n  const [newMessage, setNewMessage] = useState('');\n  const [sessionCode] = useState('ROCK2025');\n  const [currentSinger, setCurrentSinger] = useState(0);\n  const [isRecording, setIsRecording] = useState(false);\n\n  const isPlatinum = user?.subscriptionTier === 'platinum';\n\n  const sendMessage = () => {\n    if (newMessage.trim()) {\n      const message = {\n        id: Date.now().toString(),\n        user: user?.name || 'You',\n        message: newMessage,\n        timestamp: Date.now()\n      };\n      setMessages([...messages, message]);\n      setNewMessage('');\n    }\n  };\n\n  const copySessionCode = () => {\n    navigator.clipboard.writeText(sessionCode);\n    toast({\n      title: \"Session Code Copied\",\n      description: \"Share this code with friends to join the session.\",\n    });\n  };\n\n  const toggleMute = (participantId: string) => {\n    setParticipants(prev => prev.map(p =>\n      p.id === participantId ? { ...p, isMuted: !p.isMuted } : p\n    ));\n  };\n\n  const toggleVideo = (participantId: string) => {\n    setParticipants(prev => prev.map(p =>\n      p.id === participantId ? { ...p, hasVideo: !p.hasVideo } : p\n    ));\n  };\n\n  const nextSinger = () => {\n    setCurrentSinger((prev) => (prev + 1) % participants.length);\n    const nextParticipant = participants[(currentSinger + 1) % participants.length];\n    toast({\n      title: \"Turn Changed\",\n      description: `It's now ${nextParticipant.name}'s turn to sing!`,\n    });\n  };\n\n  const startCollaborativeRecording = () => {\n    if (!isPlatinum) {\n      toast({\n        title: \"Platinum Required\",\n        description: \"Upgrade to Platinum to start collaborative recording sessions.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsRecording(true);\n    toast({\n      title: \"Collaborative Recording Started\",\n      description: \"All participants are now being recorded!\",\n    });\n  };\n\n  // Calculate current time once per render to avoid purity violations\n  const currentTime = useMemo(() => Date.now(), [messages.length]);\n\n  const formatTime = (timestamp: number) => {\n    const diff = currentTime - timestamp;\n    const minutes = Math.floor(diff / 60000);\n    if (minutes < 1) return 'now';\n    return `${minutes}m ago`;\n  };\n\n  if (!isPlatinum) {\n    return (\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center\">\n        <Crown className=\"h-16 w-16 text-yellow-400 mx-auto mb-4\" />\n        <h3 className=\"text-2xl font-bold text-white mb-4\">Collaborative Recording</h3>\n        <p className=\"text-gray-300 mb-6\">\n          Join live karaoke sessions with up to 4 singers worldwide. Record together,\n          share the experience, and create amazing collaborative performances.\n        </p>\n        <Button className=\"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white font-semibold px-8 py-3\">\n          <Crown className=\"h-4 w-4 mr-2\" />\n          Upgrade to Platinum\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Session Header */}\n      <div className=\"bg-gradient-to-r from-green-600/20 to-blue-600/20 backdrop-blur-lg rounded-2xl p-6 border border-green-400/30\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-3 h-3 bg-green-400 rounded-full animate-pulse\"></div>\n            <h2 className=\"text-2xl font-bold text-white\">Live Collaborative Session</h2>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"bg-black/30 px-3 py-1 rounded-lg flex items-center space-x-2\">\n              <span className=\"text-green-400 font-mono text-sm\">#{sessionCode}</span>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={copySessionCode}\n                className=\"text-gray-400 hover:text-white p-1\"\n              >\n                <Copy className=\"h-3 w-3\" />\n              </Button>\n            </div>\n            <Button\n              size=\"sm\"\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              <UserPlus className=\"h-4 w-4 mr-2\" />\n              Invite\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-6 text-sm text-gray-300\">\n            <span className=\"flex items-center\">\n              <Users className=\"h-4 w-4 mr-1\" />\n              {participants.length}/4 participants\n            </span>\n            <span className=\"flex items-center\">\n              <Globe className=\"h-4 w-4 mr-1\" />\n              Global session\n            </span>\n            <span>Current singer: {participants[currentSinger]?.name}</span>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            <Button\n              onClick={nextSinger}\n              size=\"sm\"\n              className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n            >\n              Next Singer\n            </Button>\n            <Button\n              onClick={startCollaborativeRecording}\n              size=\"sm\"\n              className={`${isRecording ? 'bg-red-600 hover:bg-red-700' : 'bg-purple-600 hover:bg-purple-700'} text-white`}\n            >\n              {isRecording ? 'Stop Recording' : 'Start Recording'}\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"grid lg:grid-cols-4 gap-6\">\n        {/* Participants Grid */}\n        <div className=\"lg:col-span-3\">\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            {participants.map((participant, index) => (\n              <div\n                key={participant.id}\n                className={`bg-black rounded-xl overflow-hidden relative aspect-video group border-2 ${index === currentSinger ? 'border-yellow-400' : 'border-transparent'\n                  }`}\n              >\n                {participant.hasVideo ? (\n                  <div className=\"w-full h-full bg-gradient-to-br from-purple-900 to-blue-900 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <Avatar className=\"h-16 w-16 mx-auto mb-2 border-2 border-white\">\n                        <AvatarImage src={participant.avatar} />\n                        <AvatarFallback>{participant.name.charAt(0)}</AvatarFallback>\n                      </Avatar>\n                      <p className=\"text-white text-sm\">\n                        {participant.isCurrentUser ? 'Your Camera' : 'Live Camera'}\n                      </p>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"w-full h-full bg-gray-800 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <Avatar className=\"h-16 w-16 mx-auto mb-2\">\n                        <AvatarImage src={participant.avatar} />\n                        <AvatarFallback>{participant.name.charAt(0)}</AvatarFallback>\n                      </Avatar>\n                      <p className=\"text-gray-400 text-sm\">Camera off</p>\n                    </div>\n                  </div>\n                )}\n\n                {/* Current Singer Indicator */}\n                {index === currentSinger && (\n                  <div className=\"absolute top-2 left-2 bg-yellow-400 text-black px-2 py-1 rounded-full text-xs font-bold\">\n                    SINGING\n                  </div>\n                )}\n\n                {/* Recording Indicator */}\n                {isRecording && (\n                  <div className=\"absolute top-2 right-2 bg-red-600 px-2 py-1 rounded-full text-xs font-bold text-white flex items-center space-x-1\">\n                    <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\n                    <span>REC</span>\n                  </div>\n                )}\n\n                {/* Participant Info */}\n                <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      {participant.isHost && (\n                        <Crown className=\"h-4 w-4 text-yellow-400\" />\n                      )}\n                      <span className=\"text-white font-medium text-sm\">\n                        {participant.name}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center space-x-1\">\n                      {participant.isCurrentUser && (\n                        <div className=\"flex items-center space-x-1\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => toggleMute(participant.id)}\n                            className=\"w-6 h-6 p-0\"\n                          >\n                            {participant.isMuted ? (\n                              <MicOff className=\"h-3 w-3 text-red-400\" />\n                            ) : (\n                              <Mic className=\"h-3 w-3 text-white\" />\n                            )}\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => toggleVideo(participant.id)}\n                            className=\"w-6 h-6 p-0\"\n                          >\n                            {participant.hasVideo ? (\n                              <Video className=\"h-3 w-3 text-white\" />\n                            ) : (\n                              <VideoOff className=\"h-3 w-3 text-red-400\" />\n                            )}\n                          </Button>\n                        </div>\n                      )}\n                      {participant.isMuted && !participant.isCurrentUser && (\n                        <div className=\"w-6 h-6 bg-red-600 rounded-full flex items-center justify-center\">\n                          <MicOff className=\"h-3 w-3 text-white\" />\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n\n            {/* Add Participant Slot */}\n            {participants.length < 4 && (\n              <div className=\"bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-600 aspect-video flex items-center justify-center\">\n                <div className=\"text-center\">\n                  <UserPlus className=\"h-12 w-12 text-gray-400 mx-auto mb-2\" />\n                  <p className=\"text-gray-400 text-sm\">Waiting for participant</p>\n                  <p className=\"text-gray-500 text-xs\">Share session code: {sessionCode}</p>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Chat Panel */}\n        <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-4 flex flex-col h-96\">\n          <h3 className=\"text-white font-medium mb-4 flex items-center\">\n            <MessageCircle className=\"h-4 w-4 mr-2\" />\n            Live Chat\n          </h3>\n\n          {/* Messages */}\n          <div className=\"flex-1 overflow-y-auto space-y-3 mb-4\">\n            {messages.map((msg) => (\n              <div key={msg.id} className=\"space-y-1\">\n                <div className=\"flex items-center space-x-2\">\n                  <span className={`text-sm font-medium ${msg.user === 'System' ? 'text-blue-400' : 'text-purple-400'\n                    }`}>\n                    {msg.user}\n                  </span>\n                  <span className=\"text-gray-500 text-xs\">{formatTime(msg.timestamp)}</span>\n                </div>\n                <p className=\"text-gray-300 text-sm bg-black/30 rounded-lg px-3 py-2\">\n                  {msg.message}\n                </p>\n              </div>\n            ))}\n          </div>\n\n          {/* Message Input */}\n          <div className=\"flex space-x-2\">\n            <Input\n              value={newMessage}\n              onChange={(e) => setNewMessage(e.target.value)}\n              onKeyPress={(e) => e.key === 'Enter' && sendMessage()}\n              placeholder=\"Type a message...\"\n              className=\"bg-black/30 border-white/20 text-white placeholder-gray-400 text-sm\"\n            />\n            <Button\n              onClick={sendMessage}\n              size=\"sm\"\n              className=\"bg-purple-600 hover:bg-purple-700 text-white\"\n            >\n              Send\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Session Controls */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <h3 className=\"text-lg font-bold text-white mb-4\">Session Controls</h3>\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          <div className=\"space-y-3\">\n            <h4 className=\"text-white font-medium\">Recording Settings</h4>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Record All Participants</span>\n                <Switch defaultChecked />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Separate Audio Tracks</span>\n                <Switch />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Auto-sync Audio</span>\n                <Switch defaultChecked />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <h4 className=\"text-white font-medium\">Session Settings</h4>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Allow New Participants</span>\n                <Switch defaultChecked />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Public Session</span>\n                <Switch />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Turn-based Singing</span>\n                <Switch defaultChecked />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\FeatureGate.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\Header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\IntegratedUploadStudio.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":94,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":94,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Upload, Music, CheckCircle, Loader2, AlertTriangle } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from './ui/dialog';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useUserPlatformConnections, useCreateUploadJob } from '../hooks/usePlatinum';\nimport { toast } from './ui/toast';\n\ninterface IntegratedUploadStudioProps {\n  recording: {\n    id: string;\n    title: string;\n    file_url: string;\n    song: {\n      title: string;\n      artist: string;\n    };\n  };\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function IntegratedUploadStudio({ recording, isOpen, onClose }: IntegratedUploadStudioProps) {\n  const { user } = useAuth();\n  const { data: connections = [] } = useUserPlatformConnections(user?.id);\n  const createUploadJob = useCreateUploadJob();\n\n  const [selectedPlatforms, setSelectedPlatforms] = useState<string[]>([]);\n  const [uploadMetadata, setUploadMetadata] = useState({\n    title: recording.song.title,\n    artist: recording.song.artist,\n    album: 'iTone Karaoke Recordings',\n    genre: 'Karaoke',\n    description: `Karaoke performance of \"${recording.song.title}\" recorded on iTone`,\n    tags: ['karaoke', 'cover', 'singing'],\n    isPublic: true\n  });\n  const [isUploading, setIsUploading] = useState(false);\n\n  const activeConnections = connections.filter(conn => conn.connection_status === 'active');\n\n  const togglePlatform = (platformId: string) => {\n    setSelectedPlatforms(prev =>\n      prev.includes(platformId)\n        ? prev.filter(id => id !== platformId)\n        : [...prev, platformId]\n    );\n  };\n\n  const handleUpload = async () => {\n    if (!user || selectedPlatforms.length === 0) return;\n\n    setIsUploading(true);\n    try {\n      const uploadJobs = await createUploadJob.mutateAsync({\n        userId: user.id,\n        recordingId: recording.id,\n        platformIds: selectedPlatforms,\n        metadata: uploadMetadata\n      });\n\n      // Trigger actual upload processing for each job\n      for (const job of uploadJobs) {\n        if (job.platform?.name === 'spotify') {\n          // Trigger Spotify upload via edge function\n          fetch(`${import.meta.env.VITE_SUPABASE_URL}/functions/v1/spotify-upload`, {\n            method: 'POST',\n            headers: {\n              'Authorization': `Bearer ${import.meta.env.VITE_SUPABASE_ANON_KEY}`,\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ uploadJobId: job.id })\n          }).catch(console.error); // Fire and forget\n        } else {\n          // Trigger other platform uploads via general platform-upload function\n          fetch(`${import.meta.env.VITE_SUPABASE_URL}/functions/v1/platform-upload`, {\n            method: 'POST',\n            headers: {\n              'Authorization': `Bearer ${import.meta.env.VITE_SUPABASE_ANON_KEY}`,\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ uploadJobId: job.id })\n          }).catch(console.error); // Fire and forget\n        }\n      }\n\n      toast({\n        title: \"Upload Started!\",\n        description: `Your recording is being uploaded to ${selectedPlatforms.length} platform${selectedPlatforms.length > 1 ? 's' : ''}. You'll be notified when complete.`,\n      });\n\n      onClose();\n    } catch (_error) {\n      toast({\n        title: \"Upload Failed\",\n        description: \"Failed to start upload process. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const getPlatformIcon = (platformName: string) => {\n    switch (platformName) {\n      case 'spotify':\n        return <div className=\"w-6 h-6 bg-green-600 rounded flex items-center justify-center text-white font-bold text-xs\">SP</div>;\n      case 'amazon_music':\n        return <div className=\"w-6 h-6 bg-orange-600 rounded flex items-center justify-center text-white font-bold text-xs\">AM</div>;\n      case 'apple_music':\n        return <div className=\"w-6 h-6 bg-gray-800 rounded flex items-center justify-center text-white font-bold text-xs\">AP</div>;\n      case 'youtube_music':\n        return <div className=\"w-6 h-6 bg-red-600 rounded flex items-center justify-center text-white font-bold text-xs\">YT</div>;\n      case 'deezer':\n        return <div className=\"w-6 h-6 bg-purple-600 rounded flex items-center justify-center text-white font-bold text-xs\">DZ</div>;\n      default:\n        return <div className=\"w-6 h-6 bg-gray-600 rounded flex items-center justify-center text-white font-bold text-xs\">??</div>;\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl bg-gray-900 border-gray-700 text-white\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center space-x-2\">\n            <Upload className=\"h-5 w-5 text-purple-400\" />\n            <span>Upload to Streaming Platforms</span>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Recording Info */}\n          <div className=\"bg-black/30 rounded-lg p-4\">\n            <div className=\"flex items-center space-x-3\">\n              <Music className=\"h-8 w-8 text-purple-400\" />\n              <div>\n                <h3 className=\"text-white font-medium\">{recording.title}</h3>\n                <p className=\"text-gray-400 text-sm\">{recording.song.artist} - {recording.song.title}</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Platform Selection */}\n          <div>\n            <h3 className=\"text-white font-medium mb-4\">Select Platforms</h3>\n            {activeConnections.length === 0 ? (\n              <div className=\"bg-yellow-600/20 border border-yellow-400/30 rounded-lg p-4\">\n                <div className=\"flex items-center space-x-2 mb-2\">\n                  <AlertTriangle className=\"h-4 w-4 text-yellow-400\" />\n                  <span className=\"text-yellow-400 font-medium\">No Platforms Connected</span>\n                </div>\n                <p className=\"text-gray-300 text-sm\">\n                  Connect to streaming platforms first to enable uploads.\n                </p>\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-2 gap-3\">\n                {activeConnections.map((connection) => (\n                  <div\n                    key={connection.id}\n                    onClick={() => togglePlatform(connection.platform_id)}\n                    className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${selectedPlatforms.includes(connection.platform_id)\n                      ? 'border-purple-400 bg-purple-600/20'\n                      : 'border-gray-600 bg-black/30 hover:border-gray-500'\n                      }`}\n                  >\n                    <div className=\"flex items-center space-x-3\">\n                      {getPlatformIcon(connection.platform?.name || '')}\n                      <div className=\"flex-1\">\n                        <h4 className=\"text-white font-medium text-sm\">\n                          {connection.platform?.display_name}\n                        </h4>\n                        <p className=\"text-gray-400 text-xs\">\n                          @{connection.platform_username}\n                        </p>\n                      </div>\n                      {selectedPlatforms.includes(connection.platform_id) && (\n                        <CheckCircle className=\"h-4 w-4 text-purple-400\" />\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Upload Metadata */}\n          {selectedPlatforms.length > 0 && (\n            <div className=\"space-y-4\">\n              <h3 className=\"text-white font-medium\">Upload Details</h3>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm text-gray-300 mb-1 block\">Track Title</label>\n                  <Input\n                    value={uploadMetadata.title}\n                    onChange={(e) => setUploadMetadata({ ...uploadMetadata, title: e.target.value })}\n                    className=\"bg-gray-800 border-gray-600 text-white\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm text-gray-300 mb-1 block\">Artist Name</label>\n                  <Input\n                    value={uploadMetadata.artist}\n                    onChange={(e) => setUploadMetadata({ ...uploadMetadata, artist: e.target.value })}\n                    className=\"bg-gray-800 border-gray-600 text-white\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm text-gray-300 mb-1 block\">Album</label>\n                  <Input\n                    value={uploadMetadata.album}\n                    onChange={(e) => setUploadMetadata({ ...uploadMetadata, album: e.target.value })}\n                    className=\"bg-gray-800 border-gray-600 text-white\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm text-gray-300 mb-1 block\">Genre</label>\n                  <Input\n                    value={uploadMetadata.genre}\n                    onChange={(e) => setUploadMetadata({ ...uploadMetadata, genre: e.target.value })}\n                    className=\"bg-gray-800 border-gray-600 text-white\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Description</label>\n                <textarea\n                  value={uploadMetadata.description}\n                  onChange={(e) => setUploadMetadata({ ...uploadMetadata, description: e.target.value })}\n                  rows={3}\n                  className=\"w-full bg-gray-800 border border-gray-600 text-white rounded-md px-3 py-2 text-sm\"\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Upload Summary */}\n          {selectedPlatforms.length > 0 && (\n            <div className=\"bg-gradient-to-r from-purple-600/20 to-pink-600/20 border border-purple-400/30 rounded-lg p-4\">\n              <h4 className=\"text-white font-medium mb-2\">Upload Summary</h4>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-300\">Platforms selected:</span>\n                  <span className=\"text-white\">{selectedPlatforms.length}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-300\">Upload cost:</span>\n                  <span className=\"text-green-400 font-medium\">Included in subscription</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-300\">Processing time:</span>\n                  <span className=\"text-white\">5-15 minutes per platform</span>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"ghost\" onClick={onClose}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleUpload}\n              disabled={selectedPlatforms.length === 0 || isUploading}\n              className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\"\n            >\n              {isUploading ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                  Uploading...\n                </>\n              ) : (\n                <>\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  Upload to {selectedPlatforms.length} Platform{selectedPlatforms.length > 1 ? 's' : ''}\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\KaraokePlayer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'userStream'. Either include it or remove the dependency array.","line":56,"column":6,"nodeType":"ArrayExpression","endLine":56,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [userStream]","fix":{"range":[1827,1829],"text":"[userStream]"}}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[695,698],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[695,698],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect } from 'react';\nimport { Play, Pause, SkipForward, SkipBack, Volume2, Settings, Repeat } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Slider } from './ui/slider';\nimport { LyricsDisplay } from './LyricsDisplay';\nimport { AudioVisualizer } from './AudioVisualizer';\nimport { VoiceAnalyzer } from './VoiceAnalyzer';\nimport { TransposeControl } from './TransposeControl';\nimport { cn } from '../lib/utils';\n\ninterface KaraokePlayerProps {\n  song: {\n    id: string;\n    title: string;\n    artist: string;\n    duration: number;\n    youtube_url: string;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    lyrics?: any[];\n  };\n  onRecordingStart?: () => void;\n  onRecordingStop?: () => void;\n  className?: string;\n}\n\nexport function KaraokePlayer({ song, className }: KaraokePlayerProps) {\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [volume, setVolume] = useState(80);\n  const [transpose, setTranspose] = useState(0);\n  const [showSettings, setShowSettings] = useState(false);\n  const [repeat, setRepeat] = useState(false);\n  const [userStream, setUserStream] = useState<MediaStream>();\n\n  const audioRef = useRef<HTMLAudioElement>(null);\n  const intervalRef = useRef<NodeJS.Timeout>();\n\n  useEffect(() => {\n    // Initialize user microphone for voice analysis\n    const initMicrophone = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n        setUserStream(stream);\n      } catch (error) {\n        console.error('Microphone access denied:', error);\n      }\n    };\n\n    initMicrophone();\n\n    return () => {\n      if (userStream) {\n        userStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isPlaying) {\n      intervalRef.current = setInterval(() => {\n        setCurrentTime(prev => {\n          const newTime = prev + 1;\n          if (newTime >= song.duration) {\n            if (repeat) {\n              return 0;\n            } else {\n              setIsPlaying(false);\n              return song.duration;\n            }\n          }\n          return newTime;\n        });\n      }, 1000);\n    } else {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    }\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [isPlaying, song.duration, repeat]);\n\n  const togglePlay = () => {\n    setIsPlaying(!isPlaying);\n  };\n\n  const handleSeek = (newTime: number) => {\n    setCurrentTime(Math.max(0, Math.min(song.duration, newTime)));\n  };\n\n  const handleVolumeChange = (values: number[]) => {\n    setVolume(values[0]);\n  };\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const skipForward = () => {\n    handleSeek(currentTime + 10);\n  };\n\n  const skipBackward = () => {\n    handleSeek(currentTime - 10);\n  };\n\n  const openYouTube = () => {\n    window.open(song.youtube_url, '_blank');\n  };\n\n  const mockLyrics = [\n    { startTime: 0, endTime: 4000, text: \"Is this the real life?\" },\n    { startTime: 4000, endTime: 8000, text: \"Is this just fantasy?\" },\n    { startTime: 8000, endTime: 12000, text: \"Caught in a landslide\" },\n    { startTime: 12000, endTime: 16000, text: \"No escape from reality\" },\n    { startTime: 16000, endTime: 20000, text: \"Open your eyes\" },\n    { startTime: 20000, endTime: 24000, text: \"Look up to the skies and see\" },\n  ];\n\n  return (\n    <div className={cn('space-y-6', className)}>\n      {/* Song Info */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-2xl font-bold text-white mb-1\">{song.title}</h2>\n            <p className=\"text-gray-300 text-lg\">{song.artist}</p>\n          </div>\n          <Button\n            onClick={openYouTube}\n            className=\"bg-red-600 hover:bg-red-700 text-white\"\n          >\n            <Play className=\"h-4 w-4 mr-2\" />\n            YouTube\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid lg:grid-cols-3 gap-6\">\n        {/* Main Player */}\n        <div className=\"lg:col-span-2 space-y-4\">\n          {/* Audio Visualizer */}\n          <div className=\"bg-black/50 backdrop-blur-lg rounded-2xl p-6\">\n            <AudioVisualizer\n              stream={userStream}\n              type=\"bars\"\n              color=\"#8b5cf6\"\n              height={120}\n            />\n          </div>\n\n          {/* Lyrics Display */}\n          <LyricsDisplay\n            lyrics={song.lyrics || mockLyrics}\n            currentTime={currentTime}\n            isPlaying={isPlaying}\n            onTimeSeek={handleSeek}\n          />\n\n          {/* Player Controls */}\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n            {/* Progress Bar */}\n            <div className=\"mb-6\">\n              <div className=\"flex items-center justify-between text-sm text-gray-300 mb-2\">\n                <span>{formatTime(currentTime)}</span>\n                <span>{formatTime(song.duration)}</span>\n              </div>\n              <div\n                className=\"w-full bg-gray-700 rounded-full h-2 cursor-pointer\"\n                onClick={(e) => {\n                  const rect = e.currentTarget.getBoundingClientRect();\n                  const percent = (e.clientX - rect.left) / rect.width;\n                  handleSeek(percent * song.duration);\n                }}\n              >\n                <div\n                  className=\"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${(currentTime / song.duration) * 100}%` }}\n                />\n              </div>\n            </div>\n\n            {/* Control Buttons */}\n            <div className=\"flex items-center justify-center space-x-4\">\n              <Button\n                variant=\"ghost\"\n                size=\"lg\"\n                onClick={skipBackward}\n                className=\"text-white hover:bg-white/10\"\n              >\n                <SkipBack className=\"h-6 w-6\" />\n              </Button>\n\n              <Button\n                onClick={togglePlay}\n                size=\"lg\"\n                className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white rounded-full w-16 h-16\"\n              >\n                {isPlaying ? (\n                  <Pause className=\"h-8 w-8\" />\n                ) : (\n                  <Play className=\"h-8 w-8 ml-1\" />\n                )}\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"lg\"\n                onClick={skipForward}\n                className=\"text-white hover:bg-white/10\"\n              >\n                <SkipForward className=\"h-6 w-6\" />\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"lg\"\n                onClick={() => setRepeat(!repeat)}\n                className={cn(\n                  'text-white hover:bg-white/10',\n                  repeat && 'text-purple-400'\n                )}\n              >\n                <Repeat className=\"h-6 w-6\" />\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"lg\"\n                onClick={() => setShowSettings(!showSettings)}\n                className=\"text-white hover:bg-white/10\"\n              >\n                <Settings className=\"h-6 w-6\" />\n              </Button>\n            </div>\n\n            {/* Volume Control */}\n            <div className=\"flex items-center space-x-4 mt-6\">\n              <Volume2 className=\"h-4 w-4 text-gray-400\" />\n              <Slider\n                value={[volume]}\n                onValueChange={handleVolumeChange}\n                max={100}\n                step={1}\n                className=\"flex-1\"\n              />\n              <span className=\"text-sm text-gray-400 w-12 text-right\">\n                {volume}%\n              </span>\n            </div>\n          </div>\n        </div>\n\n        {/* Side Panel */}\n        <div className=\"space-y-4\">\n          {/* Voice Analyzer */}\n          <VoiceAnalyzer\n            stream={userStream}\n            targetPitch={440 + (transpose * 100)} // Rough pitch target with transpose\n          />\n\n          {/* Transpose Control */}\n          <TransposeControl\n            transpose={transpose}\n            onTransposeChange={setTranspose}\n          />\n\n          {/* Settings Panel */}\n          {showSettings && (\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4\">\n              <h4 className=\"text-white font-medium mb-4\">Player Settings</h4>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300 text-sm\">Auto-repeat</span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setRepeat(!repeat)}\n                    className={cn(\n                      'text-white hover:bg-white/10',\n                      repeat && 'text-purple-400'\n                    )}\n                  >\n                    <Repeat className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300 text-sm\">Show visualizer</span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"text-white hover:bg-white/10\"\n                  >\n                    On\n                  </Button>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300 text-sm\">Voice feedback</span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"text-white hover:bg-white/10\"\n                  >\n                    On\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Hidden audio element for future audio playback */}\n      <audio\n        ref={audioRef}\n        style={{ display: 'none' }}\n        onTimeUpdate={() => {\n          if (audioRef.current) {\n            setCurrentTime(audioRef.current.currentTime);\n          }\n        }}\n        onEnded={() => {\n          if (repeat) {\n            setCurrentTime(0);\n            if (audioRef.current) {\n              audioRef.current.currentTime = 0;\n              audioRef.current.play();\n            }\n          } else {\n            setIsPlaying(false);\n          }\n        }}\n      />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\LiveSession.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_sessionId' is defined but never used.","line":40,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":52}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Mic, MessageCircle, Settings, Crown, Globe, Copy, UserPlus } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Avatar, AvatarImage, AvatarFallback } from './ui/avatar';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from './ui/dialog';\nimport { Switch } from './ui/switch';\nimport { useAuth } from '../contexts/AuthContext';\nimport { toast } from './ui/toast';\nimport { cn } from '../lib/utils';\n\ninterface LiveSessionProps {\n  sessionId?: string;\n  isHost?: boolean;\n  className?: string;\n  onRecordingStart?: () => void;\n  onRecordingStop?: () => void;\n}\n\ninterface SessionParticipant {\n  id: string;\n  name: string;\n  avatar?: string;\n  isHost: boolean;\n  isMuted: boolean;\n  hasVideo: boolean;\n  isCurrentSinger: boolean;\n  voiceLevel: number;\n}\n\ninterface ChatMessage {\n  id: string;\n  userId: string;\n  userName: string;\n  message: string;\n  timestamp: Date;\n  type: 'text' | 'system';\n}\n\nexport function LiveSession({ sessionId: _sessionId, isHost = false, className, onRecordingStart, onRecordingStop }: LiveSessionProps) {\n  const { user } = useAuth();\n  const [participants, setParticipants] = useState<SessionParticipant[]>([\n    {\n      id: user?.id || '1',\n      name: user?.name || 'You',\n      avatar: user?.avatar,\n      isHost: true,\n      isMuted: false,\n      hasVideo: true,\n      isCurrentSinger: true,\n      voiceLevel: 0\n    }\n  ]);\n\n  const [messages, setMessages] = useState<ChatMessage[]>([\n    {\n      id: '1',\n      userId: 'system',\n      userName: 'System',\n      message: 'Welcome to the live karaoke session!',\n      timestamp: new Date(),\n      type: 'system'\n    }\n  ]);\n\n  const [newMessage, setNewMessage] = useState('');\n  const [sessionCode] = useState('LIVE2025');\n  const [isRecording, setIsRecording] = useState(false);\n  const [showSettings, setShowSettings] = useState(false);\n  const [sessionSettings, setSessionSettings] = useState({\n    allowSpectators: true,\n    requireApproval: false,\n    recordSeparateTracks: true,\n    autoMixing: true,\n    chatEnabled: true,\n    videoEnabled: true\n  });\n\n  const sendMessage = () => {\n    if (newMessage.trim()) {\n      const message: ChatMessage = {\n        id: Date.now().toString(),\n        userId: user?.id || 'unknown',\n        userName: user?.name || 'Anonymous',\n        message: newMessage,\n        timestamp: new Date(),\n        type: 'text'\n      };\n      setMessages(prev => [...prev, message]);\n      setNewMessage('');\n    }\n  };\n\n  const copySessionCode = () => {\n    navigator.clipboard.writeText(sessionCode);\n    toast({\n      title: \"Session Code Copied\",\n      description: \"Share this code with friends to join the session.\",\n    });\n  };\n\n  const toggleRecording = () => {\n    setIsRecording(!isRecording);\n    if (!isRecording) {\n      onRecordingStart?.();\n      addSystemMessage('Recording started');\n    } else {\n      onRecordingStop?.();\n      addSystemMessage('Recording stopped');\n    }\n  };\n\n  const addSystemMessage = (message: string) => {\n    const systemMessage: ChatMessage = {\n      id: Date.now().toString(),\n      userId: 'system',\n      userName: 'System',\n      message,\n      timestamp: new Date(),\n      type: 'system'\n    };\n    setMessages(prev => [...prev, systemMessage]);\n  };\n\n  const nextSinger = () => {\n    const currentIndex = participants.findIndex(p => p.isCurrentSinger);\n    const nextIndex = (currentIndex + 1) % participants.length;\n\n    setParticipants(prev => prev.map((p, index) => ({\n      ...p,\n      isCurrentSinger: index === nextIndex\n    })));\n\n    addSystemMessage(`It's now ${participants[nextIndex].name}'s turn to sing!`);\n  };\n\n  const formatTimestamp = (timestamp: Date) => {\n    return timestamp.toLocaleTimeString('en-US', {\n      hour12: false,\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  return (\n    <div className={cn('space-y-6', className)}>\n      {/* Session Header */}\n      <div className=\"bg-gradient-to-r from-green-600/20 to-blue-600/20 backdrop-blur-lg rounded-2xl p-6 border border-green-400/30\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"w-3 h-3 bg-green-400 rounded-full animate-pulse\" />\n            <div>\n              <h2 className=\"text-xl font-bold text-white\">Live Karaoke Session</h2>\n              <p className=\"text-gray-300 text-sm\">\n                {participants.length} participant{participants.length !== 1 ? 's' : ''} â€¢\n                Session #{sessionCode}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-3\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={copySessionCode}\n              className=\"text-white hover:bg-white/10\"\n            >\n              <Copy className=\"h-4 w-4 mr-1\" />\n              {sessionCode}\n            </Button>\n\n            <Button\n              size=\"sm\"\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              <UserPlus className=\"h-4 w-4 mr-2\" />\n              Invite\n            </Button>\n\n            {isHost && (\n              <Dialog open={showSettings} onOpenChange={setShowSettings}>\n                <DialogTrigger asChild>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"text-white hover:bg-white/10\"\n                  >\n                    <Settings className=\"h-4 w-4\" />\n                  </Button>\n                </DialogTrigger>\n                <DialogContent className=\"bg-gray-900 border-gray-700 text-white\">\n                  <DialogHeader>\n                    <DialogTitle>Session Settings</DialogTitle>\n                  </DialogHeader>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-300\">Allow spectators</span>\n                      <Switch\n                        checked={sessionSettings.allowSpectators}\n                        onCheckedChange={(checked) =>\n                          setSessionSettings(prev => ({ ...prev, allowSpectators: checked }))\n                        }\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-300\">Require approval to join</span>\n                      <Switch\n                        checked={sessionSettings.requireApproval}\n                        onCheckedChange={(checked) =>\n                          setSessionSettings(prev => ({ ...prev, requireApproval: checked }))\n                        }\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-300\">Record separate tracks</span>\n                      <Switch\n                        checked={sessionSettings.recordSeparateTracks}\n                        onCheckedChange={(checked) =>\n                          setSessionSettings(prev => ({ ...prev, recordSeparateTracks: checked }))\n                        }\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-300\">Auto-mixing</span>\n                      <Switch\n                        checked={sessionSettings.autoMixing}\n                        onCheckedChange={(checked) =>\n                          setSessionSettings(prev => ({ ...prev, autoMixing: checked }))\n                        }\n                      />\n                    </div>\n                  </div>\n                </DialogContent>\n              </Dialog>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"grid lg:grid-cols-4 gap-6\">\n        {/* Participants Video Grid */}\n        <div className=\"lg:col-span-3\">\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            {participants.map((participant) => (\n              <div\n                key={participant.id}\n                className={cn(\n                  'bg-black rounded-xl overflow-hidden relative aspect-video border-2 transition-all duration-300',\n                  participant.isCurrentSinger ? 'border-yellow-400 shadow-lg shadow-yellow-400/20' : 'border-transparent'\n                )}\n              >\n                {/* Video/Avatar Display */}\n                {participant.hasVideo ? (\n                  <div className=\"w-full h-full bg-gradient-to-br from-purple-900 to-blue-900 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <Avatar className=\"h-20 w-20 mx-auto mb-3 border-2 border-white\">\n                        <AvatarImage src={participant.avatar} />\n                        <AvatarFallback className=\"text-lg\">\n                          {participant.name.charAt(0)}\n                        </AvatarFallback>\n                      </Avatar>\n                      <p className=\"text-white text-sm\">Camera Active</p>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"w-full h-full bg-gray-800 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <Avatar className=\"h-20 w-20 mx-auto mb-3\">\n                        <AvatarImage src={participant.avatar} />\n                        <AvatarFallback className=\"text-lg\">\n                          {participant.name.charAt(0)}\n                        </AvatarFallback>\n                      </Avatar>\n                      <p className=\"text-gray-400 text-sm\">Camera Off</p>\n                    </div>\n                  </div>\n                )}\n\n                {/* Current Singer Badge */}\n                {participant.isCurrentSinger && (\n                  <div className=\"absolute top-3 left-3 bg-yellow-400 text-black px-3 py-1 rounded-full text-xs font-bold animate-pulse\">\n                    SINGING NOW\n                  </div>\n                )}\n\n                {/* Recording Indicator */}\n                {isRecording && (\n                  <div className=\"absolute top-3 right-3 bg-red-600 px-2 py-1 rounded-full text-xs font-bold text-white flex items-center space-x-1\">\n                    <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\" />\n                    <span>REC</span>\n                  </div>\n                )}\n\n                {/* Host Badge */}\n                {participant.isHost && (\n                  <div className=\"absolute top-3 left-1/2 transform -translate-x-1/2 bg-purple-600 px-2 py-1 rounded-full text-xs font-bold text-white flex items-center space-x-1\">\n                    <Crown className=\"h-3 w-3\" />\n                    <span>HOST</span>\n                  </div>\n                )}\n\n                {/* Participant Info */}\n                <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-white font-medium text-sm\">\n                      {participant.name}\n                    </span>\n\n                    {/* Voice Level Indicator */}\n                    <div className=\"flex items-center space-x-2\">\n                      {participant.voiceLevel > 0 && (\n                        <div className=\"flex items-center space-x-1\">\n                          {[...Array(5)].map((_, i) => (\n                            <div\n                              key={i}\n                              className={cn(\n                                'w-1 h-3 rounded-full transition-all duration-100',\n                                i < Math.floor(participant.voiceLevel / 20)\n                                  ? 'bg-green-400'\n                                  : 'bg-gray-600'\n                              )}\n                            />\n                          ))}\n                        </div>\n                      )}\n\n                      {participant.isMuted && (\n                        <div className=\"w-6 h-6 bg-red-600 rounded-full flex items-center justify-center\">\n                          <Mic className=\"h-3 w-3 text-white\" />\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n\n            {/* Add Participant Slot */}\n            {participants.length < 4 && (\n              <div className=\"bg-gray-800/50 rounded-xl border-2 border-dashed border-gray-600 aspect-video flex items-center justify-center\">\n                <div className=\"text-center\">\n                  <UserPlus className=\"h-12 w-12 text-gray-400 mx-auto mb-2\" />\n                  <p className=\"text-gray-400 text-sm\">Waiting for participant</p>\n                  <p className=\"text-gray-500 text-xs\">Share: {sessionCode}</p>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Session Controls */}\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4 mt-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-4\">\n                <Button\n                  onClick={toggleRecording}\n                  className={cn(\n                    'font-semibold',\n                    isRecording\n                      ? 'bg-red-600 hover:bg-red-700'\n                      : 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700'\n                  )}\n                >\n                  {isRecording ? 'Stop Recording' : 'Start Recording'}\n                </Button>\n\n                {isHost && (\n                  <Button\n                    onClick={nextSinger}\n                    variant=\"outline\"\n                    className=\"border-white/20 text-white hover:bg-white/10\"\n                  >\n                    Next Singer\n                  </Button>\n                )}\n              </div>\n\n              <div className=\"flex items-center space-x-2 text-sm text-gray-300\">\n                <Globe className=\"h-4 w-4\" />\n                <span>{participants.length}/4 participants</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Chat Panel */}\n        <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-4 flex flex-col h-96\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-white font-medium flex items-center\">\n              <MessageCircle className=\"h-4 w-4 mr-2\" />\n              Live Chat\n            </h3>\n            <span className=\"text-xs text-gray-400\">\n              {messages.length} messages\n            </span>\n          </div>\n\n          {/* Messages */}\n          <div className=\"flex-1 overflow-y-auto space-y-2 mb-4\">\n            {messages.map((msg) => (\n              <div key={msg.id} className=\"space-y-1\">\n                <div className=\"flex items-center space-x-2\">\n                  <span className={cn(\n                    'text-xs font-medium',\n                    msg.type === 'system' ? 'text-blue-400' : 'text-purple-400'\n                  )}>\n                    {msg.userName}\n                  </span>\n                  <span className=\"text-gray-500 text-xs\">\n                    {formatTimestamp(msg.timestamp)}\n                  </span>\n                </div>\n                <p className={cn(\n                  'text-sm rounded-lg px-3 py-2',\n                  msg.type === 'system'\n                    ? 'bg-blue-600/20 text-blue-300 italic'\n                    : 'bg-black/30 text-gray-300'\n                )}>\n                  {msg.message}\n                </p>\n              </div>\n            ))}\n          </div>\n\n          {/* Message Input */}\n          {sessionSettings.chatEnabled && (\n            <div className=\"flex space-x-2\">\n              <Input\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                onKeyPress={(e) => e.key === 'Enter' && sendMessage()}\n                placeholder=\"Type a message...\"\n                className=\"bg-black/30 border-white/20 text-white placeholder-gray-400 text-sm\"\n              />\n              <Button\n                onClick={sendMessage}\n                size=\"sm\"\n                className=\"bg-purple-600 hover:bg-purple-700 text-white\"\n              >\n                Send\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\LyricsDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\NotificationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\PlatformConnectionManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":61,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_platformId' is defined but never used.","line":72,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":46}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1110,1113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1110,1113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Link2, CheckCircle, ExternalLink, Unlink, Loader2 } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useStreamingPlatforms, useUserPlatformConnections, useConnectPlatform } from '../hooks/usePlatinum';\nimport { toast } from './ui/toast';\n\nexport function PlatformConnectionManager() {\n  const { user } = useAuth();\n  const { data: platforms = [] } = useStreamingPlatforms();\n  const { data: connections = [] } = useUserPlatformConnections(user?.id);\n  const connectPlatform = useConnectPlatform();\n  const [connectingPlatform, setConnectingPlatform] = useState<string | null>(null);\n\n  const isConnected = (platformId: string) => {\n    return connections.some(conn =>\n      conn.platform_id === platformId && conn.connection_status === 'active'\n    );\n  };\n\n  const getConnection = (platformId: string) => {\n    return connections.find(conn => conn.platform_id === platformId);\n  };\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const handleConnect = async (platform: any) => {\n    if (!user) return;\n\n    setConnectingPlatform(platform.id);\n\n    try {\n      // Redirect to OAuth flow based on platform\n      if (platform.name === 'spotify') {\n        const authUrl = `https://itone.rocks?spotify_auth=true&user_id=${user.id}`;\n        window.location.href = authUrl;\n      } else {\n        // For other platforms, use mock OAuth for demo\n        const mockOAuthResponse = {\n          access_token: `mock_token_${platform.name}_${Date.now()}`,\n          refresh_token: `mock_refresh_${platform.name}_${Date.now()}`,\n          expires_in: 3600,\n          platform_user_id: `user_${Math.random().toString(36).substr(2, 9)}`,\n          platform_username: `${user.name?.toLowerCase().replace(' ', '_')}_${platform.name}`\n        };\n\n        await connectPlatform.mutateAsync({\n          userId: user.id,\n          platformId: platform.id,\n          accessToken: mockOAuthResponse.access_token,\n          refreshToken: mockOAuthResponse.refresh_token,\n          expiresAt: new Date(Date.now() + mockOAuthResponse.expires_in * 1000).toISOString(),\n          platformUserId: mockOAuthResponse.platform_user_id,\n          platformUsername: mockOAuthResponse.platform_username\n        });\n\n        toast({\n          title: \"Platform Connected!\",\n          description: `Successfully connected to ${platform.display_name}. You can now upload directly to this platform.`,\n        });\n      }\n    } catch (_error) {\n      toast({\n        title: \"Connection Failed\",\n        description: `Failed to connect to ${platform.display_name}. Please try again.`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setConnectingPlatform(null);\n    }\n  };\n\n  const handleDisconnect = async (_platformId: string) => {\n    // In a real app, this would revoke the OAuth token\n    toast({\n      title: \"Platform Disconnected\",\n      description: \"Platform has been disconnected from your account.\",\n    });\n  };\n\n  const getPlatformIcon = (platformName: string) => {\n    switch (platformName) {\n      case 'spotify':\n        return <div className=\"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center text-white font-bold text-xs\">SP</div>;\n      case 'amazon_music':\n        return <div className=\"w-8 h-8 bg-orange-600 rounded-lg flex items-center justify-center text-white font-bold text-xs\">AM</div>;\n      case 'apple_music':\n        return <div className=\"w-8 h-8 bg-gray-800 rounded-lg flex items-center justify-center text-white font-bold text-xs\">AP</div>;\n      case 'youtube_music':\n        return <div className=\"w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center text-white font-bold text-xs\">YT</div>;\n      case 'deezer':\n        return <div className=\"w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center text-white font-bold text-xs\">DZ</div>;\n      default:\n        return <div className=\"w-8 h-8 bg-gray-600 rounded-lg flex items-center justify-center text-white font-bold text-xs\">??</div>;\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'text-green-400';\n      case 'expired': return 'text-yellow-400';\n      case 'revoked': return 'text-red-400';\n      default: return 'text-gray-400';\n    }\n  };\n\n  return (\n    <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"text-xl font-bold text-white flex items-center\">\n          <Link2 className=\"h-5 w-5 mr-2 text-purple-400\" />\n          Platform Connections\n        </h3>\n        <div className=\"text-sm text-gray-300\">\n          {connections.filter(c => c.connection_status === 'active').length} of {platforms.length} connected\n        </div>\n      </div>\n\n      <div className=\"space-y-4\">\n        {platforms.map((platform) => {\n          const connection = getConnection(platform.id);\n          const connected = isConnected(platform.id);\n\n          return (\n            <div key={platform.id} className=\"bg-black/30 rounded-xl p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-4\">\n                  {getPlatformIcon(platform.name)}\n                  <div>\n                    <h4 className=\"text-white font-medium\">{platform.display_name}</h4>\n                    <p className=\"text-gray-400 text-sm\">\n                      Upload cost: ${platform.api_base_cost.toFixed(2)} (included in subscription)\n                    </p>\n                    {connected && connection && (\n                      <div className=\"flex items-center space-x-2 mt-1\">\n                        <CheckCircle className=\"h-3 w-3 text-green-400\" />\n                        <span className={`text-xs ${getStatusColor(connection.connection_status)}`}>\n                          Connected as @{connection.platform_username}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"flex items-center space-x-2\">\n                  {connected ? (\n                    <>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDisconnect(platform.id)}\n                        className=\"text-red-400 hover:bg-red-500/20\"\n                      >\n                        <Unlink className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"text-white hover:bg-white/10\"\n                      >\n                        <ExternalLink className=\"h-4 w-4\" />\n                      </Button>\n                    </>\n                  ) : (\n                    <Button\n                      onClick={() => handleConnect(platform)}\n                      disabled={connectingPlatform === platform.id}\n                      size=\"sm\"\n                      className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\"\n                    >\n                      {connectingPlatform === platform.id ? (\n                        <>\n                          <Loader2 className=\"h-4 w-4 mr-1 animate-spin\" />\n                          Connecting...\n                        </>\n                      ) : (\n                        <>\n                          <Link2 className=\"h-4 w-4 mr-1\" />\n                          Connect\n                        </>\n                      )}\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Connection Benefits */}\n      <div className=\"mt-6 bg-gradient-to-r from-green-600/20 to-blue-600/20 border border-green-400/30 rounded-lg p-4\">\n        <h4 className=\"text-white font-medium mb-2\">Why Connect Platforms?</h4>\n        <ul className=\"text-gray-300 text-sm space-y-1\">\n          <li>â€¢ One-click uploads directly from iTone</li>\n          <li>â€¢ Automatic metadata and artwork inclusion</li>\n          <li>â€¢ No separate billing or API setup required</li>\n          <li>â€¢ Upload history and analytics tracking</li>\n          <li>â€¢ Bulk upload to multiple platforms simultaneously</li>\n        </ul>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\PlatformUploadPricing.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\PlatinumCheckout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_createSubscription' is assigned a value but never used.","line":20,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Crown, Shield, Check, Loader2, Star, Users, Upload, Zap } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from './ui/dialog';\nimport { useAuth } from '../contexts/AuthContext';\nimport { usePlatinumPricing, useCreatePlatinumSubscription } from '../hooks/usePlatinum';\nimport { createCheckoutSession, redirectToCheckout } from '../lib/stripe';\nimport { toast } from './ui/toast';\n\n\ninterface PlatinumCheckoutProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function PlatinumCheckout({ isOpen, onClose }: PlatinumCheckoutProps) {\n  const { user } = useAuth();\n\n  const { data: pricing } = usePlatinumPricing();\n  const _createSubscription = useCreatePlatinumSubscription();\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  // Check for successful Spotify connection on component mount\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    if (urlParams.get('spotify_connected') === 'true') {\n      toast({\n        title: \"Spotify Connected!\",\n        description: \"Your Spotify account has been successfully linked to iTone.\",\n      });\n      // Clean up URL\n      window.history.replaceState({}, document.title, window.location.pathname);\n    }\n  }, []);\n\n  const handleSubscribe = async () => {\n    if (!user || !pricing) return;\n\n    setIsProcessing(true);\n    try {\n      // Create Stripe checkout session with integrated pricing\n      const sessionId = await createCheckoutSession(\n        'price_platinum_integrated', // Special price ID for integrated Platinum\n        undefined, // Let Stripe create customer\n        {\n          metadata: {\n            plan_type: 'platinum_integrated',\n            user_id: user.id,\n            base_cost: pricing.base_cost.toString(),\n            platform_costs: pricing.platform_costs.toString(),\n            itone_margin: pricing.itone_margin.toString(),\n            total_cost: pricing.total_cost.toString()\n          }\n        }\n      );\n\n      // Redirect to Stripe Checkout\n      await redirectToCheckout(sessionId);\n    } catch (error) {\n      console.error('Checkout error:', error);\n      toast({\n        title: \"Payment Error\",\n        description: \"Failed to start checkout process. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const features = [\n    {\n      icon: <Zap className=\"h-5 w-5 text-purple-400\" />,\n      title: 'Ultra HD Recording',\n      description: 'Professional-grade 4K video with lossless audio'\n    },\n    {\n      icon: <Users className=\"h-5 w-5 text-blue-400\" />,\n      title: '4-Person Collaboration',\n      description: 'Record with up to 4 friends simultaneously'\n    },\n    {\n      icon: <Upload className=\"h-5 w-5 text-green-400\" />,\n      title: 'Integrated Platform Access',\n      description: 'Direct uploads to Spotify, Apple Music, Amazon Music & more'\n    },\n    {\n      icon: <Star className=\"h-5 w-5 text-yellow-400\" />,\n      title: 'Professional Audio Suite',\n      description: 'Auto-tune, reverb, mixing, and mastering tools'\n    },\n    {\n      icon: <Shield className=\"h-5 w-5 text-cyan-400\" />,\n      title: '24/7 Priority Support',\n      description: 'Dedicated support team and priority assistance'\n    }\n  ];\n\n  if (!pricing) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl bg-gray-900 border-gray-700 text-white\">\n        <DialogHeader>\n          <DialogTitle className=\"text-center text-2xl\">\n            <div className=\"flex items-center justify-center space-x-2 mb-2\">\n              <Crown className=\"h-6 w-6 text-purple-400\" />\n              <span>Platinum Subscription</span>\n            </div>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Integrated Pricing Breakdown */}\n          <div className=\"bg-gradient-to-r from-purple-600/20 to-pink-600/20 rounded-xl p-6 border border-purple-400/30\">\n            <h3 className=\"text-lg font-bold text-white mb-4 text-center\">All-Inclusive Monthly Plan</h3>\n\n            <div className=\"space-y-3 mb-4\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-gray-300\">Platinum Subscription</span>\n                <span className=\"text-white font-medium\">${pricing.base_cost.toFixed(2)}</span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-gray-300\">Streaming Platform APIs</span>\n                <span className=\"text-white font-medium\">${pricing.platform_costs.toFixed(2)}</span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-gray-300\">iTone Service Fee (20%)</span>\n                <span className=\"text-white font-medium\">${pricing.itone_margin.toFixed(2)}</span>\n              </div>\n              <div className=\"border-t border-white/20 pt-3\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-xl font-bold text-white\">Total Monthly</span>\n                  <span className=\"text-2xl font-bold text-purple-400\">${pricing.total_cost.toFixed(2)}</span>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-green-600/20 border border-green-400/30 rounded-lg p-3\">\n              <p className=\"text-green-400 text-sm font-medium text-center\">\n                âœ¨ Includes 10 platform uploads per month â€¢ OAuth setup managed by iTone\n              </p>\n            </div>\n          </div>\n\n          {/* What's Included */}\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-semibold text-white\">Everything Included</h3>\n            {features.map((feature, index) => (\n              <div key={index} className=\"flex items-start space-x-3\">\n                <div className=\"mt-1\">\n                  {feature.icon}\n                </div>\n                <div className=\"flex-1\">\n                  <h4 className=\"text-white font-medium\">{feature.title}</h4>\n                  <p className=\"text-gray-400 text-sm\">{feature.description}</p>\n                </div>\n                <Check className=\"h-5 w-5 text-green-400 mt-1\" />\n              </div>\n            ))}\n          </div>\n\n          {/* Platform Integration Details */}\n          <div className=\"bg-black/30 rounded-lg p-4\">\n            <h4 className=\"text-white font-medium mb-3\">Integrated Platform Access</h4>\n            <div className=\"grid grid-cols-2 gap-3 text-sm\">\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"w-4 h-4 bg-green-600 rounded\"></div>\n                <span className=\"text-gray-300\">Spotify</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"w-4 h-4 bg-orange-600 rounded\"></div>\n                <span className=\"text-gray-300\">Amazon Music</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"w-4 h-4 bg-gray-800 rounded\"></div>\n                <span className=\"text-gray-300\">Apple Music</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"w-4 h-4 bg-red-600 rounded\"></div>\n                <span className=\"text-gray-300\">YouTube Music</span>\n              </div>\n            </div>\n            <p className=\"text-gray-400 text-xs mt-3\">\n              No separate payments â€¢ No API setup required â€¢ Managed by iTone\n            </p>\n          </div>\n\n          {/* Security & Trial Info */}\n          <div className=\"bg-blue-600/20 border border-blue-400/30 rounded-lg p-4\">\n            <div className=\"flex items-center space-x-2 mb-2\">\n              <Shield className=\"h-4 w-4 text-blue-400\" />\n              <span className=\"text-blue-400 font-medium\">Secure & Risk-Free</span>\n            </div>\n            <ul className=\"text-gray-300 text-sm space-y-1\">\n              <li>â€¢ 7-day free trial included</li>\n              <li>â€¢ Cancel anytime, no hidden fees</li>\n              <li>â€¢ Secure payment processing via Stripe</li>\n              <li>â€¢ Your platform accounts remain private</li>\n            </ul>\n          </div>\n\n          {/* Subscribe Button */}\n          <Button\n            onClick={handleSubscribe}\n            disabled={isProcessing}\n            className=\"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 text-lg rounded-full\"\n          >\n            {isProcessing ? (\n              <>\n                <Loader2 className=\"h-5 w-5 mr-2 animate-spin\" />\n                Processing...\n              </>\n            ) : (\n              <>\n                <Crown className=\"h-5 w-5 mr-2\" />\n                Start 7-Day Free Trial\n              </>\n            )}\n          </Button>\n\n          <p className=\"text-gray-400 text-xs text-center\">\n            By subscribing, you agree to our Terms of Service and Privacy Policy.\n            Your trial starts immediately with full access to all features.\n          </p>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\PlatinumUpgrade.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\PricingPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\Queue.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":51,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_nextSong' is assigned a value but never used.","line":78,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":81,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":20}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { Clock, User, Trash2, Play } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { useToast } from './ui/use-toast';\nimport { useLocation } from 'wouter';\n\ninterface QueueItem {\n  id: string;\n  songId: string;\n  userId: string;\n  userName: string;\n  timestamp: number;\n  song: {\n    id: string;\n    title: string;\n    artist: string;\n    duration: number;\n    genre: string;\n    difficulty: string;\n  };\n}\n\nexport function Queue() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, setLocation] = useLocation();\n\n  const { data: queue = [], isLoading } = useQuery({\n    queryKey: ['queue'],\n    queryFn: async () => {\n      // Mock empty queue for demo\n      return [];\n    },\n    refetchInterval: 5000 // Refresh every 5 seconds\n  });\n\n  const removeFromQueue = async (queueId: string) => {\n    try {\n      const response = await fetch(`/api/queue/${queueId}`, {\n        method: 'DELETE'\n      });\n\n      if (!response.ok) throw new Error('Failed to remove from queue');\n\n      queryClient.invalidateQueries({ queryKey: ['queue'] });\n      toast({\n        title: \"Removed from queue\",\n        description: \"Song has been removed from the queue.\",\n      });\n    } catch (_error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to remove song from queue.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const playNext = async () => {\n    try {\n      const response = await fetch('/api/queue/next', {\n        method: 'POST'\n      });\n\n      if (!response.ok) {\n        if (response.status === 404) {\n          toast({\n            title: \"Queue is empty\",\n            description: \"Add some songs to the queue first.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        throw new Error('Failed to get next song');\n      }\n\n      const _nextSong = await response.json();\n      queryClient.invalidateQueries({ queryKey: ['queue'] });\n      setLocation('/karaoke');\n    } catch (_error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to start karaoke session.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const formatDuration = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"text-center py-12\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-400 mx-auto\"></div>\n        <p className=\"text-gray-300 mt-4\">Loading queue...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Queue Header */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-2xl font-bold text-white mb-2\">Karaoke Queue</h2>\n            <p className=\"text-gray-300\">\n              {queue.length} {queue.length === 1 ? 'song' : 'songs'} in queue\n            </p>\n          </div>\n          {queue.length > 0 && (\n            <Button\n              onClick={playNext}\n              className=\"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-6 py-3 rounded-full font-semibold\"\n            >\n              <Play className=\"h-4 w-4 mr-2\" />\n              Start Karaoke\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Queue Items */}\n      <div className=\"space-y-3\">\n        {queue.length === 0 ? (\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-12 text-center\">\n            <Clock className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-xl font-bold text-white mb-2\">Queue is Empty</h3>\n            <p className=\"text-gray-300\">\n              Add some songs from the library to get started!\n            </p>\n          </div>\n        ) : (\n          queue.map((item: QueueItem, index: number) => (\n            <div\n              key={item.id}\n              className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4 hover:bg-white/15 transition-all duration-300 group\"\n            >\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold text-lg\">\n                    {index + 1}\n                  </div>\n                  <div className=\"flex-1\">\n                    <h4 className=\"text-lg font-semibold text-white\">\n                      {item.song.title}\n                    </h4>\n                    <p className=\"text-gray-300\">{item.song.artist}</p>\n                    <div className=\"flex items-center space-x-4 text-sm text-gray-400 mt-1\">\n                      <span className=\"flex items-center\">\n                        <User className=\"h-3 w-3 mr-1\" />\n                        {item.userName}\n                      </span>\n                      <span className=\"flex items-center\">\n                        <Clock className=\"h-3 w-3 mr-1\" />\n                        {formatDuration(item.song.duration)}\n                      </span>\n                      <span className=\"text-purple-400\">{item.song.genre}</span>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\n                  {index === 0 && (\n                    <Button\n                      onClick={playNext}\n                      size=\"sm\"\n                      className=\"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white\"\n                    >\n                      <Play className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => removeFromQueue(item.id)}\n                    className=\"text-red-400 hover:bg-red-500/20\"\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\RecordingStudio.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_maxQuality' is assigned a value but never used.","line":47,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeCamera'. Either include it or remove the dependency array.","line":56,"column":6,"nodeType":"ArrayExpression","endLine":56,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [initializeCamera]","fix":{"range":[2525,2527],"text":"[initializeCamera]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":69,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadToPlatform' is assigned a value but never used.","line":154,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":154,"endColumn":25}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect } from 'react';\nimport { Video, VideoOff, Mic, MicOff, Square, Play, Download, Users, Globe, Upload } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Switch } from './ui/switch';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\nimport { TransposeControl } from './TransposeControl';\nimport { IntegratedUploadStudio } from './IntegratedUploadStudio';\nimport { toast } from './ui/toast';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useUserSubscription } from '../hooks/useSubscription';\nimport { usePlatinumSubscription } from '../hooks/usePlatinum';\n\ninterface RecordingStudioProps {\n  song?: {\n    id: string;\n    title: string;\n    artist: string;\n    youtube_url: string;\n  };\n  initialTranspose?: number;\n}\n\nexport function RecordingStudio({ song, initialTranspose = 0 }: RecordingStudioProps) {\n  const { user } = useAuth();\n  const { data: subscription } = useUserSubscription(user?.id);\n  const { data: platinumSubscription } = usePlatinumSubscription(user?.id);\n  const [isRecording, setIsRecording] = useState(false);\n  const [isVideoEnabled, setIsVideoEnabled] = useState(true);\n  const [isAudioEnabled, setIsAudioEnabled] = useState(true);\n  const [isCollaborative, setIsCollaborative] = useState(false);\n  const [transpose, setTranspose] = useState(initialTranspose);\n  const [recordedBlob, setRecordedBlob] = useState<Blob | null>(null);\n  const [showUploadStudio, setShowUploadStudio] = useState(false);\n  const [connectedUsers, setConnectedUsers] = useState(1);\n  const [recordingQuality, setRecordingQuality] = useState<'standard' | 'high'>('standard');\n  const [includeYouTubeAudio, setIncludeYouTubeAudio] = useState(true);\n  const [autoTune, setAutoTune] = useState(false);\n  const [echoEffect, setEchoEffect] = useState(false);\n\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const streamRef = useRef<MediaStream | null>(null);\n\n  const hasGoldOrHigher = subscription?.plan?.name === 'Gold' || subscription?.plan?.name === 'Platinum';\n  const hasPlatinum = subscription?.plan?.name === 'Platinum';\n  const hasIntegratedPlatinum = !!platinumSubscription;\n  const _maxQuality = subscription?.plan?.download_quality || 'standard';\n\n  useEffect(() => {\n    initializeCamera();\n    return () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n\n  const initializeCamera = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: isVideoEnabled,\n        audio: isAudioEnabled\n      });\n\n      streamRef.current = stream;\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n      }\n    } catch (_error) {\n      toast({\n        title: \"Camera Access Denied\",\n        description: \"Please allow camera and microphone access to record karaoke.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const toggleRecording = async () => {\n    if (!isRecording) {\n      startRecording();\n    } else {\n      stopRecording();\n    }\n  };\n\n  const startRecording = async () => {\n    if (!streamRef.current) {\n      await initializeCamera();\n    }\n\n    if (streamRef.current) {\n      const options = {\n        mimeType: recordingQuality === 'high' && hasGoldOrHigher ? 'video/webm;codecs=vp9' : 'video/webm'\n      };\n\n      const mediaRecorder = new MediaRecorder(streamRef.current, options);\n      mediaRecorderRef.current = mediaRecorder;\n\n      const chunks: BlobPart[] = [];\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          chunks.push(event.data);\n        }\n      };\n\n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunks, { type: 'video/webm' });\n        setRecordedBlob(blob);\n        toast({\n          title: \"Recording Complete!\",\n          description: `Your karaoke performance has been saved${recordingQuality === 'high' ? ' in HD quality' : ''}.`,\n        });\n      };\n\n      mediaRecorder.start();\n      setIsRecording(true);\n\n      if (isCollaborative) {\n        toast({\n          title: \"Live Collaboration Started\",\n          description: `Up to ${subscription?.plan?.max_collaborators || 1} users can join your session!`,\n        });\n      }\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n    }\n  };\n\n  const downloadRecording = () => {\n    if (recordedBlob) {\n      const url = URL.createObjectURL(recordedBlob);\n      const a = document.createElement('a');\n      a.href = url;\n      const quality = recordingQuality === 'ultra' ? 'UHD' : recordingQuality === 'high' ? 'HD' : 'SD';\n      const transpose = transpose !== 0 ? `_transpose${transpose > 0 ? '+' : ''}${transpose}` : '';\n      a.download = `karaoke-${song?.title || 'recording'}${transpose}_${quality}-${Date.now()}.webm`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Download Started\",\n        description: `Your ${quality} recording is being downloaded.`,\n      });\n    }\n  };\n\n  const uploadToPlatform = async (platform: 'youtube' | 'spotify') => {\n    if (!hasPlatinum) {\n      toast({\n        title: \"Platinum Required\",\n        description: \"Upgrade to Platinum to upload directly to external platforms.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    toast({\n      title: `Uploading to ${platform === 'youtube' ? 'YouTube' : 'Spotify'}`,\n      description: \"Your recording is being uploaded. This may take a few minutes.\",\n    });\n\n    // Simulate upload\n    setTimeout(() => {\n      toast({\n        title: \"Upload Successful!\",\n        description: `Your recording has been uploaded to ${platform === 'youtube' ? 'YouTube' : 'Spotify'}.`,\n      });\n    }, 3000);\n  };\n\n  const toggleCamera = async () => {\n    setIsVideoEnabled(!isVideoEnabled);\n    if (streamRef.current) {\n      const videoTrack = streamRef.current.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !isVideoEnabled;\n      }\n    }\n  };\n\n  const toggleMicrophone = async () => {\n    setIsAudioEnabled(!isAudioEnabled);\n    if (streamRef.current) {\n      const audioTrack = streamRef.current.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !isAudioEnabled;\n      }\n    }\n  };\n\n  const startCollaborativeSession = () => {\n    if (!hasGoldOrHigher) {\n      toast({\n        title: \"Gold or Platinum Required\",\n        description: \"Upgrade to Gold or Platinum to access collaborative recording features.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsCollaborative(true);\n    setConnectedUsers(Math.min(Math.floor(Math.random() * 3) + 2, subscription?.plan?.max_collaborators || 2));\n    toast({\n      title: \"Collaborative Session Started\",\n      description: \"Other users can now join your recording session!\",\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Recording Controls Header */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-2xl font-bold text-white\">Recording Studio</h2>\n          <div className=\"flex items-center space-x-4\">\n            {isCollaborative && (\n              <div className=\"flex items-center space-x-2 bg-green-600/20 px-3 py-1 rounded-full\">\n                <Globe className=\"h-4 w-4 text-green-400\" />\n                <span className=\"text-green-400 text-sm font-medium\">\n                  {connectedUsers} connected\n                </span>\n              </div>\n            )}\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-white text-sm\">Quality:</span>\n              <Select value={recordingQuality} onValueChange={(value: 'standard' | 'high') => setRecordingQuality(value)}>\n                <SelectTrigger className=\"w-32 bg-white/10 border-white/20 text-white\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent className=\"bg-gray-800 border-gray-600\">\n                  <SelectItem value=\"standard\">Standard</SelectItem>\n                  <SelectItem value=\"high\" disabled={!hasGoldOrHigher}>\n                    HD {!hasGoldOrHigher && '(Gold+)'}\n                  </SelectItem>\n                  <SelectItem value=\"ultra\" disabled={!hasPlatinum}>\n                    Ultra HD {!hasPlatinum && '(Platinum)'}\n                  </SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </div>\n\n        {song && (\n          <div className=\"bg-black/30 rounded-lg p-4 mb-4\">\n            <h3 className=\"text-lg font-semibold text-white\">{song.title}</h3>\n            <p className=\"text-gray-300\">{song.artist}</p>\n          </div>\n        )}\n      </div>\n\n      {/* Video Preview and Controls */}\n      <div className=\"grid lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2 space-y-4\">\n          {/* Camera Preview */}\n          <div className=\"bg-black rounded-2xl overflow-hidden relative aspect-video\">\n            <video\n              ref={videoRef}\n              autoPlay\n              muted\n              playsInline\n              className=\"w-full h-full object-cover\"\n            />\n\n            {/* Recording Indicator */}\n            {isRecording && (\n              <div className=\"absolute top-4 left-4 flex items-center space-x-2 bg-red-600 px-3 py-1 rounded-full\">\n                <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\n                <span className=\"text-white text-sm font-medium\">\n                  REC {recordingQuality === 'high' ? 'HD' : 'SD'}\n                </span>\n              </div>\n            )}\n\n            {/* Collaborative Viewers */}\n            {isCollaborative && (\n              <div className=\"absolute top-4 right-4 bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full\">\n                <div className=\"flex items-center space-x-2\">\n                  <Users className=\"h-4 w-4 text-white\" />\n                  <span className=\"text-white text-sm\">{connectedUsers}</span>\n                </div>\n              </div>\n            )}\n\n            {/* Transpose Indicator */}\n            {transpose !== 0 && (\n              <div className=\"absolute bottom-4 right-4 bg-purple-600/80 backdrop-blur-sm px-3 py-1 rounded-full\">\n                <span className=\"text-white text-sm font-medium\">\n                  Transpose: {transpose > 0 ? '+' : ''}{transpose}\n                </span>\n              </div>\n            )}\n\n            {/* Camera Controls Overlay */}\n            <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center space-x-4\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={toggleCamera}\n                className={`rounded-full w-12 h-12 ${isVideoEnabled ? 'bg-white/20' : 'bg-red-600'}`}\n              >\n                {isVideoEnabled ? (\n                  <Video className=\"h-5 w-5 text-white\" />\n                ) : (\n                  <VideoOff className=\"h-5 w-5 text-white\" />\n                )}\n              </Button>\n\n              <Button\n                onClick={toggleRecording}\n                size=\"lg\"\n                className={`rounded-full w-16 h-16 ${isRecording\n                    ? 'bg-red-600 hover:bg-red-700'\n                    : 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700'\n                  }`}\n              >\n                {isRecording ? (\n                  <Square className=\"h-6 w-6 text-white\" />\n                ) : (\n                  <div className=\"w-6 h-6 bg-white rounded-full\"></div>\n                )}\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={toggleMicrophone}\n                className={`rounded-full w-12 h-12 ${isAudioEnabled ? 'bg-white/20' : 'bg-red-600'}`}\n              >\n                {isAudioEnabled ? (\n                  <Mic className=\"h-5 w-5 text-white\" />\n                ) : (\n                  <MicOff className=\"h-5 w-5 text-white\" />\n                )}\n              </Button>\n            </div>\n          </div>\n\n          {/* YouTube Integration */}\n          {song && (\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h4 className=\"text-white font-medium\">YouTube Playback</h4>\n                  <p className=\"text-gray-400 text-sm\">Play along with the original track</p>\n                </div>\n                <Button\n                  onClick={() => window.open(song.youtube_url, '_blank')}\n                  className=\"bg-red-600 hover:bg-red-700 text-white\"\n                >\n                  <Play className=\"h-4 w-4 mr-2\" />\n                  Open YouTube\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Controls Panel */}\n        <div className=\"space-y-4\">\n          {/* Transpose Control */}\n          <TransposeControl\n            transpose={transpose}\n            onTransposeChange={setTranspose}\n          />\n\n          {/* Recording Options */}\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4\">\n            <h4 className=\"text-white font-medium mb-4\">Recording Options</h4>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Include YouTube Audio</span>\n                <Switch\n                  checked={includeYouTubeAudio}\n                  onCheckedChange={setIncludeYouTubeAudio}\n                />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Auto-tune</span>\n                <Switch\n                  checked={autoTune}\n                  onCheckedChange={setAutoTune}\n                />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Echo Effect</span>\n                <Switch\n                  checked={echoEffect}\n                  onCheckedChange={setEchoEffect}\n                />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-gray-300 text-sm\">Enhanced Quality</span>\n                <Switch\n                  checked={recordingQuality !== 'standard'}\n                  onCheckedChange={(checked) => setRecordingQuality(checked ? (hasPlatinum ? 'ultra' : 'high') : 'standard')}\n                  disabled={!hasGoldOrHigher}\n                />\n              </div>\n              {!hasGoldOrHigher && recordingQuality !== 'standard' && (\n                <p className=\"text-yellow-400 text-xs\">Enhanced recording requires Gold or Platinum subscription</p>\n              )}\n            </div>\n          </div>\n\n          {/* Collaborative Features */}\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h4 className=\"text-white font-medium\">Collaborative Recording</h4>\n              <Switch\n                checked={isCollaborative}\n                onCheckedChange={hasGoldOrHigher ? setIsCollaborative : () => {\n                  toast({\n                    title: \"Gold or Platinum Required\",\n                    description: \"Upgrade to Gold or Platinum for collaborative recording.\",\n                    variant: \"destructive\",\n                  });\n                }}\n                disabled={!hasGoldOrHigher}\n              />\n            </div>\n\n            {!hasGoldOrHigher && (\n              <p className=\"text-yellow-400 text-xs mb-3\">\n                Collaborative recording requires Gold or Platinum subscription\n              </p>\n            )}\n\n            {isCollaborative && hasGoldOrHigher && (\n              <div className=\"space-y-3\">\n                <div className=\"bg-green-600/20 border border-green-400/30 rounded-lg p-3\">\n                  <p className=\"text-green-400 text-sm font-medium mb-2\">Session Active</p>\n                  <p className=\"text-gray-300 text-xs\">\n                    Session Code: <span className=\"font-mono bg-black/30 px-2 py-1 rounded\">LIVE2025</span>\n                  </p>\n                </div>\n                <Button\n                  size=\"sm\"\n                  className={`w-full bg-green-600 hover:bg-green-700 text-white`}\n                  onClick={startCollaborativeSession}\n                >\n                  <Users className=\"h-4 w-4 mr-2\" />\n                  Invite Friends (Max {subscription?.plan?.max_collaborators || 2})\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/* Download and Upload Options */}\n          {recordedBlob && (\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-4\">\n              <h4 className=\"text-white font-medium mb-4\">Export Recording</h4>\n              <div className=\"space-y-3\">\n                <Button\n                  onClick={downloadRecording}\n                  className=\"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\"\n                >\n                  <Download className=\"h-4 w-4 mr-2\" />\n                  Download {recordingQuality === 'ultra' ? 'UHD' : recordingQuality === 'high' ? 'HD' : 'SD'} Recording\n                </Button>\n\n                {/* Integrated Platform Uploads (Platinum Only) */}\n                {hasIntegratedPlatinum && (\n                  <Button\n                    onClick={() => setShowUploadStudio(true)}\n                    className=\"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white\"\n                  >\n                    <Upload className=\"h-4 w-4 mr-2\" />\n                    Upload to Streaming Platforms\n                  </Button>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Integrated Upload Studio */}\n      {recordedBlob && (\n        <IntegratedUploadStudio\n          recording={{\n            id: `temp-${Date.now()}`,\n            title: `Karaoke Recording - ${song?.title || 'Untitled'}`,\n            file_url: URL.createObjectURL(recordedBlob),\n            song: song || { title: 'Untitled', artist: 'Unknown' }\n          }}\n          isOpen={showUploadStudio}\n          onClose={() => setShowUploadStudio(false)}\n        />\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\SongLibrary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\SubscriptionManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":29,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":51,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":20}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { CreditCard, Calendar, AlertTriangle, CheckCircle, XCircle, Download, Crown } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from './ui/dialog';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useUserSubscription, useUpdateSubscription } from '../hooks/useSubscription';\nimport { toast } from './ui/toast';\n\nexport function SubscriptionManager() {\n  const { user } = useAuth();\n  const { data: subscription } = useUserSubscription(user?.id);\n  const updateSubscriptionMutation = useUpdateSubscription();\n  const [showCancelDialog, setShowCancelDialog] = useState(false);\n\n  const handleCancelSubscription = async () => {\n    if (!subscription) return;\n\n    try {\n      await updateSubscriptionMutation.mutateAsync({\n        subscriptionId: subscription.id,\n        updates: { cancel_at_period_end: true }\n      });\n\n      toast({\n        title: \"Subscription Cancelled\",\n        description: \"Your subscription will end at the current billing period.\",\n      });\n      setShowCancelDialog(false);\n    } catch (_error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to cancel subscription. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleReactivateSubscription = async () => {\n    if (!subscription) return;\n\n    try {\n      await updateSubscriptionMutation.mutateAsync({\n        subscriptionId: subscription.id,\n        updates: { cancel_at_period_end: false }\n      });\n\n      toast({\n        title: \"Subscription Reactivated\",\n        description: \"Your subscription will continue at the next billing period.\",\n      });\n    } catch (_error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to reactivate subscription. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'text-green-400';\n      case 'trialing': return 'text-blue-400';\n      case 'past_due': return 'text-yellow-400';\n      case 'cancelled': return 'text-red-400';\n      case 'expired': return 'text-gray-400';\n      default: return 'text-gray-400';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'active': return <CheckCircle className=\"h-5 w-5 text-green-400\" />;\n      case 'trialing': return <Crown className=\"h-5 w-5 text-blue-400\" />;\n      case 'past_due': return <AlertTriangle className=\"h-5 w-5 text-yellow-400\" />;\n      case 'cancelled': return <XCircle className=\"h-5 w-5 text-red-400\" />;\n      case 'expired': return <XCircle className=\"h-5 w-5 text-gray-400\" />;\n      default: return <AlertTriangle className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  if (!subscription) {\n    return (\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center\">\n        <CreditCard className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n        <h3 className=\"text-xl font-bold text-white mb-2\">No Active Subscription</h3>\n        <p className=\"text-gray-300 mb-6\">\n          Subscribe to unlock premium features and enhance your karaoke experience.\n        </p>\n        <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\">\n          View Plans\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Current Subscription */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h2 className=\"text-2xl font-bold text-white\">Subscription Management</h2>\n          {getStatusIcon(subscription.status)}\n        </div>\n\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div>\n              <h3 className=\"text-white font-medium mb-2\">Current Plan</h3>\n              <div className=\"bg-black/30 rounded-lg p-4\">\n                <div className=\"flex items-center space-x-3 mb-2\">\n                  <Crown className=\"h-6 w-6 text-yellow-400\" />\n                  <span className=\"text-xl font-bold text-white\">{subscription.plan?.name}</span>\n                </div>\n                <p className=\"text-gray-300\">${subscription.plan?.price_monthly}/month</p>\n              </div>\n            </div>\n\n            <div>\n              <h3 className=\"text-white font-medium mb-2\">Status</h3>\n              <div className=\"bg-black/30 rounded-lg p-4\">\n                <div className=\"flex items-center space-x-2\">\n                  {getStatusIcon(subscription.status)}\n                  <span className={`font-medium capitalize ${getStatusColor(subscription.status)}`}>\n                    {subscription.status}\n                  </span>\n                </div>\n                {subscription.status === 'trialing' && subscription.trial_end && (\n                  <p className=\"text-gray-400 text-sm mt-1\">\n                    Trial ends: {new Date(subscription.trial_end).toLocaleDateString()}\n                  </p>\n                )}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div>\n              <h3 className=\"text-white font-medium mb-2\">Billing Period</h3>\n              <div className=\"bg-black/30 rounded-lg p-4\">\n                <div className=\"flex items-center space-x-2 mb-1\">\n                  <Calendar className=\"h-4 w-4 text-blue-400\" />\n                  <span className=\"text-white text-sm\">\n                    {new Date(subscription.current_period_start).toLocaleDateString()} -\n                    {new Date(subscription.current_period_end).toLocaleDateString()}\n                  </span>\n                </div>\n                <p className=\"text-gray-400 text-xs\">\n                  Next billing: {new Date(subscription.current_period_end).toLocaleDateString()}\n                </p>\n              </div>\n            </div>\n\n            <div>\n              <h3 className=\"text-white font-medium mb-2\">Payment Method</h3>\n              <div className=\"bg-black/30 rounded-lg p-4\">\n                <div className=\"flex items-center space-x-2\">\n                  <CreditCard className=\"h-4 w-4 text-green-400\" />\n                  <span className=\"text-white text-sm\">â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ 4242</span>\n                </div>\n                <p className=\"text-gray-400 text-xs mt-1\">Expires 12/2027</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-wrap gap-3 mt-6 pt-6 border-t border-white/10\">\n          <Button variant=\"outline\" className=\"border-white/20 text-white hover:bg-white/10\">\n            <CreditCard className=\"h-4 w-4 mr-2\" />\n            Update Payment Method\n          </Button>\n\n          <Button variant=\"outline\" className=\"border-white/20 text-white hover:bg-white/10\">\n            <Download className=\"h-4 w-4 mr-2\" />\n            Download Invoices\n          </Button>\n\n          {subscription.cancel_at_period_end ? (\n            <Button\n              onClick={handleReactivateSubscription}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              <CheckCircle className=\"h-4 w-4 mr-2\" />\n              Reactivate Subscription\n            </Button>\n          ) : (\n            <Dialog open={showCancelDialog} onOpenChange={setShowCancelDialog}>\n              <DialogTrigger asChild>\n                <Button variant=\"outline\" className=\"border-red-400/50 text-red-400 hover:bg-red-500/20\">\n                  <XCircle className=\"h-4 w-4 mr-2\" />\n                  Cancel Subscription\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"bg-gray-900 border-gray-700 text-white\">\n                <DialogHeader>\n                  <DialogTitle>Cancel Subscription</DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4\">\n                  <p className=\"text-gray-300\">\n                    Are you sure you want to cancel your {subscription.plan?.name} subscription?\n                  </p>\n                  <div className=\"bg-yellow-600/20 border border-yellow-400/30 rounded-lg p-4\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <AlertTriangle className=\"h-4 w-4 text-yellow-400\" />\n                      <span className=\"text-yellow-400 font-medium\">Important</span>\n                    </div>\n                    <ul className=\"text-gray-300 text-sm space-y-1\">\n                      <li>â€¢ Your subscription will remain active until {new Date(subscription.current_period_end).toLocaleDateString()}</li>\n                      <li>â€¢ You'll lose access to premium features after this date</li>\n                      <li>â€¢ Your recordings will be preserved but limited to standard quality</li>\n                      <li>â€¢ You can reactivate anytime before the period ends</li>\n                    </ul>\n                  </div>\n                  <div className=\"flex justify-end space-x-2\">\n                    <Button variant=\"ghost\" onClick={() => setShowCancelDialog(false)}>\n                      Keep Subscription\n                    </Button>\n                    <Button\n                      onClick={handleCancelSubscription}\n                      className=\"bg-red-600 hover:bg-red-700 text-white\"\n                    >\n                      Confirm Cancellation\n                    </Button>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n          )}\n        </div>\n\n        {/* Cancellation Notice */}\n        {subscription.cancel_at_period_end && (\n          <div className=\"mt-4 bg-red-600/20 border border-red-400/30 rounded-lg p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <AlertTriangle className=\"h-4 w-4 text-red-400\" />\n              <span className=\"text-red-400 font-medium\">Subscription Cancelled</span>\n            </div>\n            <p className=\"text-gray-300 text-sm mt-1\">\n              Your subscription will end on {new Date(subscription.current_period_end).toLocaleDateString()}.\n              You can reactivate it anytime before this date.\n            </p>\n          </div>\n        )}\n      </div>\n\n      {/* Billing History */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <h3 className=\"text-xl font-bold text-white mb-4\">Billing History</h3>\n        <div className=\"space-y-3\">\n          {/* Mock billing history */}\n          {[\n            { date: '2025-01-01', amount: subscription.plan?.price_monthly || 0, status: 'paid', invoice: 'INV-2025-001' },\n            { date: '2024-12-01', amount: subscription.plan?.price_monthly || 0, status: 'paid', invoice: 'INV-2024-012' },\n            { date: '2024-11-01', amount: subscription.plan?.price_monthly || 0, status: 'paid', invoice: 'INV-2024-011' }\n          ].map((bill, index) => (\n            <div key={index} className=\"bg-black/30 rounded-lg p-4 flex items-center justify-between\">\n              <div className=\"flex items-center space-x-4\">\n                <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n                <div>\n                  <p className=\"text-white font-medium\">${bill.amount.toFixed(2)}</p>\n                  <p className=\"text-gray-400 text-sm\">{new Date(bill.date).toLocaleDateString()}</p>\n                </div>\n              </div>\n              <div className=\"flex items-center space-x-3\">\n                <span className=\"text-green-400 text-sm capitalize\">{bill.status}</span>\n                <Button size=\"sm\" variant=\"ghost\" className=\"text-white hover:bg-white/10\">\n                  <Download className=\"h-4 w-4 mr-1\" />\n                  Invoice\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\TransposeControl.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\UploadDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\UserProfile.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nA:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\UserProfile.tsx:30:56\n  28 |   const stats = useMemo(() => {\n  29 |     // Pre-generate random values for each recording to avoid calling Math.random during render\n> 30 |     const viewCounts = recordings.map(() => Math.floor(Math.random() * 100));\n     |                                                        ^^^^^^^^^^^^^ Cannot call impure function\n  31 |     return {\n  32 |       songsRecorded: recordings.length,\n  33 |       savedSongs: userSongs.length,","line":30,"column":56,"nodeType":null,"endLine":30,"endColumn":69}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { User, Music, Video, Trophy, Edit3, Crown, Download, Share2 } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Avatar, AvatarImage, AvatarFallback } from './ui/avatar';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from './ui/dialog';\nimport { Input } from './ui/input';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useUserSongs, useUserRecordings } from '../hooks/useSupabase';\n\nexport function UserProfile() {\n  const { user, updateProfile } = useAuth();\n  const [isEditing, setIsEditing] = useState(false);\n  const [editForm, setEditForm] = useState({\n    name: user?.name || '',\n    bio: user?.bio || ''\n  });\n\n  // Load user's saved songs and recordings\n  const { data: userSongs = [] } = useUserSongs(user?.id);\n  const { data: recordings = [] } = useUserRecordings(user?.id);\n\n  const handleSave = () => {\n    updateProfile(editForm);\n    setIsEditing(false);\n  };\n\n  // Calculate stats using useMemo to avoid re-running Math.random() on every render\n  const stats = useMemo(() => {\n    // Pre-generate random values for each recording to avoid calling Math.random during render\n    const viewCounts = recordings.map(() => Math.floor(Math.random() * 100));\n    return {\n      songsRecorded: recordings.length,\n      savedSongs: userSongs.length,\n      totalViews: viewCounts.reduce((acc, views) => acc + views, 0)\n    };\n  }, [recordings, userSongs]);\n\n  const isPlatinum = user?.subscriptionTier === 'platinum';\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Main Profile Card */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <div className=\"flex items-start justify-between mb-6\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"relative\">\n              <Avatar className=\"h-20 w-20 border-4 border-purple-400\">\n                <AvatarImage src={user?.avatar} alt={user?.name} />\n                <AvatarFallback className=\"bg-purple-600 text-white text-2xl\">\n                  {user?.name?.charAt(0) || 'U'}\n                </AvatarFallback>\n              </Avatar>\n              {isPlatinum && (\n                <div className=\"absolute -top-2 -right-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full p-1\">\n                  <Crown className=\"h-4 w-4 text-white\" />\n                </div>\n              )}\n            </div>\n            <div>\n              <div className=\"flex items-center space-x-2 mb-1\">\n                <h2 className=\"text-3xl font-bold text-white\">{user?.name}</h2>\n                {isPlatinum && (\n                  <span className=\"bg-gradient-to-r from-yellow-400 to-orange-500 text-black px-2 py-1 rounded-full text-xs font-bold\">\n                    PLATINUM\n                  </span>\n                )}\n              </div>\n              <p className=\"text-gray-300\">{user?.email}</p>\n              {user?.bio && (\n                <p className=\"text-gray-400 text-sm mt-2 max-w-md\">{user.bio}</p>\n              )}\n            </div>\n          </div>\n\n          <Dialog open={isEditing} onOpenChange={setIsEditing}>\n            <DialogTrigger asChild>\n              <Button variant=\"ghost\" size=\"sm\" className=\"text-white hover:bg-white/10\">\n                <Edit3 className=\"h-4 w-4 mr-2\" />\n                Edit Profile\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"bg-gray-900 border-gray-700 text-white\">\n              <DialogHeader>\n                <DialogTitle>Edit Profile</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium text-gray-300 mb-2 block\">Name</label>\n                  <Input\n                    value={editForm.name}\n                    onChange={(e) => setEditForm({ ...editForm, name: e.target.value })}\n                    className=\"bg-gray-800 border-gray-600 text-white\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium text-gray-300 mb-2 block\">Bio</label>\n                  <Input\n                    value={editForm.bio}\n                    onChange={(e) => setEditForm({ ...editForm, bio: e.target.value })}\n                    placeholder=\"Tell us about yourself...\"\n                    className=\"bg-gray-800 border-gray-600 text-white\"\n                  />\n                </div>\n                <div className=\"flex justify-end space-x-2 pt-4\">\n                  <Button variant=\"ghost\" onClick={() => setIsEditing(false)}>\n                    Cancel\n                  </Button>\n                  <Button onClick={handleSave} className=\"bg-purple-600 hover:bg-purple-700\">\n                    Save Changes\n                  </Button>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-3 gap-6 mb-6\">\n          <div className=\"text-center bg-black/30 rounded-xl p-4\">\n            <div className=\"flex items-center justify-center mb-2\">\n              <Music className=\"h-6 w-6 text-purple-400\" />\n            </div>\n            <div className=\"text-3xl font-bold text-white\">{stats.songsRecorded}</div>\n            <div className=\"text-sm text-gray-400\">Songs Recorded</div>\n          </div>\n          <div className=\"text-center bg-black/30 rounded-xl p-4\">\n            <div className=\"flex items-center justify-center mb-2\">\n              <Video className=\"h-6 w-6 text-blue-400\" />\n            </div>\n            <div className=\"text-3xl font-bold text-white\">{stats.savedSongs}</div>\n            <div className=\"text-sm text-gray-400\">Saved Songs</div>\n          </div>\n          <div className=\"text-center bg-black/30 rounded-xl p-4\">\n            <div className=\"flex items-center justify-center mb-2\">\n              <Trophy className=\"h-6 w-6 text-yellow-400\" />\n            </div>\n            <div className=\"text-3xl font-bold text-white\">{stats.totalViews}</div>\n            <div className=\"text-sm text-gray-400\">Total Views</div>\n          </div>\n        </div>\n      </div>\n\n      {/* Saved Songs */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <h3 className=\"text-xl font-bold text-white mb-4 flex items-center\">\n          <Music className=\"h-5 w-5 mr-2 text-purple-400\" />\n          My Saved Songs ({userSongs.length})\n        </h3>\n\n        {userSongs.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <Music className=\"h-12 w-12 text-gray-400 mx-auto mb-3\" />\n            <p className=\"text-gray-400\">No saved songs yet</p>\n            <p className=\"text-gray-500 text-sm\">Save songs from the library to see them here</p>\n          </div>\n        ) : (\n          <div className=\"grid gap-3\">\n            {userSongs.slice(0, 5).map((userSong) => (\n              <div key={userSong.id} className=\"bg-black/30 rounded-lg p-4 flex items-center justify-between\">\n                <div>\n                  <h4 className=\"text-white font-medium\">{userSong.song.title}</h4>\n                  <p className=\"text-gray-400 text-sm\">{userSong.song.artist}</p>\n                  {userSong.transpose_value !== 0 && (\n                    <span className=\"text-purple-400 text-xs\">\n                      Transpose: {userSong.transpose_value > 0 ? '+' : ''}{userSong.transpose_value}\n                    </span>\n                  )}\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <Button size=\"sm\" variant=\"ghost\" className=\"text-white hover:bg-white/10\">\n                    <Video className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            ))}\n            {userSongs.length > 5 && (\n              <p className=\"text-gray-400 text-sm text-center\">\n                +{userSongs.length - 5} more songs\n              </p>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Recent Recordings */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <h3 className=\"text-xl font-bold text-white mb-4 flex items-center\">\n          <Video className=\"h-5 w-5 mr-2 text-blue-400\" />\n          Recent Recordings ({recordings.length})\n        </h3>\n\n        {recordings.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <Video className=\"h-12 w-12 text-gray-400 mx-auto mb-3\" />\n            <p className=\"text-gray-400\">No recordings yet</p>\n            <p className=\"text-gray-500 text-sm\">Start recording to see your performances here</p>\n          </div>\n        ) : (\n          <div className=\"grid gap-3\">\n            {recordings.slice(0, 3).map((recording) => (\n              <div key={recording.id} className=\"bg-black/30 rounded-lg p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h4 className=\"text-white font-medium\">{recording.title}</h4>\n                    <p className=\"text-gray-400 text-sm\">\n                      {new Date(recording.created_at).toLocaleDateString()}\n                    </p>\n                    <div className=\"flex items-center space-x-3 mt-1\">\n                      {recording.is_collaborative && (\n                        <span className=\"text-green-400 text-xs bg-green-400/20 px-2 py-1 rounded\">\n                          Collaborative\n                        </span>\n                      )}\n                      {recording.quality === 'high' && (\n                        <span className=\"text-yellow-400 text-xs bg-yellow-400/20 px-2 py-1 rounded\">\n                          HD Quality\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button size=\"sm\" variant=\"ghost\" className=\"text-white hover:bg-white/10\">\n                      <Download className=\"h-4 w-4\" />\n                    </Button>\n                    <Button size=\"sm\" variant=\"ghost\" className=\"text-white hover:bg-white/10\">\n                      <Share2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Subscription Status */}\n      <div className={`rounded-2xl p-6 ${isPlatinum\n        ? 'bg-gradient-to-r from-yellow-600/20 to-orange-600/20 border border-yellow-400/30'\n        : 'bg-white/10 backdrop-blur-lg'\n        }`}>\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-xl font-bold text-white mb-2 flex items-center\">\n              {isPlatinum ? (\n                <>\n                  <Crown className=\"h-5 w-5 mr-2 text-yellow-400\" />\n                  Platinum Member\n                </>\n              ) : (\n                <>\n                  <User className=\"h-5 w-5 mr-2 text-gray-400\" />\n                  Free Account\n                </>\n              )}\n            </h3>\n            <p className=\"text-gray-300 text-sm\">\n              {isPlatinum\n                ? 'Enjoy unlimited HD recordings, collaborative sessions, and direct platform uploads'\n                : 'Upgrade to Platinum for HD recordings, collaborative features, and platform integrations'\n              }\n            </p>\n          </div>\n          {!isPlatinum && (\n            <Button className=\"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white font-semibold\">\n              <Crown className=\"h-4 w-4 mr-2\" />\n              Upgrade to Platinum\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Recent Activity */}\n      <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6\">\n        <h3 className=\"text-lg font-semibold text-white mb-4\">Recent Activity</h3>\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center space-x-3 text-sm\">\n            <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n            <span className=\"text-gray-300\">Recorded \"Bohemian Rhapsody\" with transpose +2</span>\n            <span className=\"text-gray-500\">2 hours ago</span>\n          </div>\n          <div className=\"flex items-center space-x-3 text-sm\">\n            <div className=\"w-2 h-2 bg-blue-400 rounded-full\"></div>\n            <span className=\"text-gray-300\">Joined collaborative session \"Rock Night\"</span>\n            <span className=\"text-gray-500\">1 day ago</span>\n          </div>\n          <div className=\"flex items-center space-x-3 text-sm\">\n            <div className=\"w-2 h-2 bg-purple-400 rounded-full\"></div>\n            <span className=\"text-gray-300\">Downloaded recording in HD quality</span>\n            <span className=\"text-gray-500\">3 days ago</span>\n          </div>\n          {isPlatinum && (\n            <div className=\"flex items-center space-x-3 text-sm\">\n              <div className=\"w-2 h-2 bg-yellow-400 rounded-full\"></div>\n              <span className=\"text-gray-300\">Published to Spotify and Apple Music</span>\n              <span className=\"text-gray-500\">5 days ago</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\VoiceAnalyzer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'startAnalysis' function makes the dependencies of useEffect Hook (at line 161) change on every render. Move it inside the useEffect callback. Alternatively, wrap the definition of 'startAnalysis' in its own useCallback() Hook.","line":78,"column":9,"nodeType":"VariableDeclarator","endLine":130,"endColumn":4}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4192,4195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4192,4195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState, useRef } from 'react';\nimport { TrendingUp, Volume2, Music2, Target } from 'lucide-react';\nimport { Progress } from './ui/progress';\nimport { cn } from '../lib/utils';\n\ninterface VoiceAnalyzerProps {\n  stream?: MediaStream;\n  targetPitch?: number;\n  className?: string;\n  onAnalysis?: (analysis: VoiceAnalysis) => void;\n}\n\ninterface VoiceAnalysis {\n  pitch: number;\n  volume: number;\n  stability: number;\n  inTune: boolean;\n  confidence: number;\n}\n\nexport function VoiceAnalyzer({ stream, targetPitch, className, onAnalysis }: VoiceAnalyzerProps) {\n  const [analysis, setAnalysis] = useState<VoiceAnalysis>({\n    pitch: 0,\n    volume: 0,\n    stability: 0,\n    inTune: false,\n    confidence: 0\n  });\n\n  const audioContextRef = useRef<AudioContext>();\n  const analyserRef = useRef<AnalyserNode>();\n  const animationRef = useRef<number>();\n  const pitchHistoryRef = useRef<number[]>([]);\n\n  const detectPitch = (frequencyData: Float32Array, sampleRate: number): number => {\n    // Simplified pitch detection using peak frequency\n    let maxIndex = 0;\n    let maxValue = -Infinity;\n\n    // Focus on vocal range (80Hz - 1000Hz)\n    const minIndex = Math.floor((80 / sampleRate) * frequencyData.length * 2);\n    const maxIndexRange = Math.floor((1000 / sampleRate) * frequencyData.length * 2);\n\n    for (let i = minIndex; i < Math.min(maxIndexRange, frequencyData.length); i++) {\n      if (frequencyData[i] > maxValue) {\n        maxValue = frequencyData[i];\n        maxIndex = i;\n      }\n    }\n\n    const frequency = (maxIndex * sampleRate) / (frequencyData.length * 2);\n\n    // Convert frequency to cents (relative to A4 = 440Hz)\n    if (frequency > 0) {\n      return 1200 * Math.log2(frequency / 440);\n    }\n\n    return 0;\n  };\n\n  const calculateStability = (pitchHistory: number[]): number => {\n    if (pitchHistory.length < 2) return 0;\n\n    let variance = 0;\n    const mean = pitchHistory.reduce((sum, pitch) => sum + pitch, 0) / pitchHistory.length;\n\n    for (const pitch of pitchHistory) {\n      variance += Math.pow(pitch - mean, 2);\n    }\n\n    variance /= pitchHistory.length;\n    const standardDeviation = Math.sqrt(variance);\n\n    // Convert to stability percentage (lower deviation = higher stability)\n    return Math.max(0, 100 - (standardDeviation / 10));\n  };\n\n  const startAnalysis = () => {\n    if (!analyserRef.current || !audioContextRef.current) return;\n\n    const analyser = analyserRef.current;\n    const audioContext = audioContextRef.current;\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Float32Array(bufferLength);\n\n    const analyze = () => {\n      analyser.getFloatFrequencyData(dataArray);\n\n      // Calculate volume (RMS)\n      let sum = 0;\n      for (let i = 0; i < dataArray.length; i++) {\n        const value = Math.pow(10, dataArray[i] / 20); // Convert dB to linear\n        sum += value * value;\n      }\n      const volume = Math.sqrt(sum / dataArray.length) * 100;\n\n      // Simple pitch detection using autocorrelation\n      const pitch = detectPitch(dataArray, audioContext.sampleRate);\n\n      // Update pitch history for stability calculation\n      pitchHistoryRef.current.push(pitch);\n      if (pitchHistoryRef.current.length > 10) {\n        pitchHistoryRef.current.shift();\n      }\n\n      // Calculate pitch stability\n      const stability = calculateStability(pitchHistoryRef.current);\n\n      // Check if in tune (within 50 cents of target)\n      const inTune = targetPitch ? Math.abs(pitch - targetPitch) < 50 : false;\n\n      // Calculate confidence based on volume and stability\n      const confidence = Math.min(100, (volume / 50) * (stability / 100) * 100);\n\n      const newAnalysis = {\n        pitch,\n        volume: Math.min(100, volume),\n        stability,\n        inTune,\n        confidence\n      };\n\n      setAnalysis(newAnalysis);\n      onAnalysis?.(newAnalysis);\n\n      animationRef.current = requestAnimationFrame(analyze);\n    };\n\n    analyze();\n  };\n\n  useEffect(() => {\n    if (!stream) return;\n\n    const setupAnalysis = async () => {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      const analyser = audioContext.createAnalyser();\n      const source = audioContext.createMediaStreamSource(stream);\n\n      analyser.fftSize = 4096;\n      analyser.smoothingTimeConstant = 0.3;\n      source.connect(analyser);\n\n      audioContextRef.current = audioContext;\n      analyserRef.current = analyser;\n\n      startAnalysis();\n    };\n\n    setupAnalysis();\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, [stream, startAnalysis]);\n\n  const getPitchIndicatorColor = () => {\n    if (!targetPitch) return 'bg-blue-500';\n\n    const difference = Math.abs(analysis.pitch - targetPitch);\n    if (difference < 25) return 'bg-green-500';\n    if (difference < 50) return 'bg-yellow-500';\n    return 'bg-red-500';\n  };\n\n  const formatPitch = (cents: number) => {\n    if (cents === 0) return 'A4';\n\n    const noteNames = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const A4Cents = 0; // A4 = 0 cents\n    const totalCents = A4Cents + cents;\n    const octave = Math.floor(totalCents / 1200) + 4;\n    const noteIndex = Math.floor((totalCents % 1200) / 100);\n\n    return `${noteNames[noteIndex]}${octave}`;\n  };\n\n  return (\n    <div className={cn(\n      'bg-white/10 backdrop-blur-lg rounded-2xl p-6',\n      className\n    )}>\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"text-lg font-bold text-white flex items-center\">\n          <TrendingUp className=\"h-5 w-5 mr-2 text-purple-400\" />\n          Voice Analysis\n        </h3>\n        <div className={cn(\n          'w-3 h-3 rounded-full',\n          analysis.volume > 10 ? 'bg-green-400 animate-pulse' : 'bg-gray-600'\n        )} />\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-4 mb-6\">\n        {/* Volume Meter */}\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-gray-300 flex items-center\">\n              <Volume2 className=\"h-4 w-4 mr-1\" />\n              Volume\n            </span>\n            <span className=\"text-sm text-white font-medium\">\n              {Math.round(analysis.volume)}%\n            </span>\n          </div>\n          <Progress\n            value={analysis.volume}\n            className=\"h-2 bg-gray-700\"\n          />\n        </div>\n\n        {/* Pitch Stability */}\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-gray-300 flex items-center\">\n              <Target className=\"h-4 w-4 mr-1\" />\n              Stability\n            </span>\n            <span className=\"text-sm text-white font-medium\">\n              {Math.round(analysis.stability)}%\n            </span>\n          </div>\n          <Progress\n            value={analysis.stability}\n            className=\"h-2 bg-gray-700\"\n          />\n        </div>\n      </div>\n\n      {/* Pitch Display */}\n      <div className=\"bg-black/30 rounded-xl p-4 mb-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <span className=\"text-sm text-gray-300 flex items-center\">\n            <Music2 className=\"h-4 w-4 mr-1\" />\n            Current Pitch\n          </span>\n          <span className={cn(\n            'text-sm font-medium px-2 py-1 rounded-full',\n            analysis.inTune ? 'bg-green-600/30 text-green-400' : 'bg-red-600/30 text-red-400'\n          )}>\n            {analysis.inTune ? 'In Tune' : 'Off Pitch'}\n          </span>\n        </div>\n\n        <div className=\"text-center\">\n          <div className=\"text-2xl font-bold text-white mb-2\">\n            {formatPitch(analysis.pitch)}\n          </div>\n\n          {/* Pitch Indicator */}\n          <div className=\"relative w-full h-4 bg-gray-700 rounded-full overflow-hidden\">\n            <div\n              className={cn(\n                'absolute top-0 h-full w-1 transition-all duration-200',\n                getPitchIndicatorColor()\n              )}\n              style={{\n                left: `${Math.max(0, Math.min(100, 50 + (analysis.pitch / 100)))}%`\n              }}\n            />\n            {targetPitch && (\n              <div\n                className=\"absolute top-0 h-full w-0.5 bg-white\"\n                style={{\n                  left: `${Math.max(0, Math.min(100, 50 + (targetPitch / 100)))}%`\n                }}\n              />\n            )}\n          </div>\n\n          <div className=\"flex justify-between text-xs text-gray-400 mt-1\">\n            <span>Low</span>\n            <span>Target</span>\n            <span>High</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Confidence Score */}\n      <div className=\"bg-black/30 rounded-xl p-4\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <span className=\"text-sm text-gray-300\">Performance Score</span>\n          <span className=\"text-lg font-bold text-white\">\n            {Math.round(analysis.confidence)}/100\n          </span>\n        </div>\n        <Progress\n          value={analysis.confidence}\n          className=\"h-3 bg-gray-700\"\n        />\n        <p className=\"text-xs text-gray-400 mt-2\">\n          Based on pitch accuracy, volume consistency, and vocal stability\n        </p>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":35,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":35,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { cn } from \"../../lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants };","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":55,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":55,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { cn } from \"../../lib/utils\";\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n);\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nButton.displayName = \"Button\";\n\nexport { Button, buttonVariants };","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\toast.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":155,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":155,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport * as ToastPrimitives from \"@radix-ui/react-toast\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"../../lib/utils\";\nimport { useToast } from \"./use-toast\";\n\nconst ToastProvider = ToastPrimitives.Provider;\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n));\nToastViewport.displayName = ToastPrimitives.Viewport.displayName;\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  );\n});\nToast.displayName = ToastPrimitives.Root.displayName;\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-xs font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n));\nToastAction.displayName = ToastPrimitives.Action.displayName;\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n));\nToastClose.displayName = ToastPrimitives.Close.displayName;\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n));\nToastTitle.displayName = ToastPrimitives.Title.displayName;\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n));\nToastDescription.displayName = ToastPrimitives.Description.displayName;\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>;\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n};\n\nexport function Toaster() {\n  const { toasts } = useToast();\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        );\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  );\n}\n\nimport { toast } from \"./use-toast\";\n\nexport { toast };","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\components\\ui\\use-toast.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'actionTypes' is assigned a value but only used as a type.","line":14,"column":7,"nodeType":"Identifier","messageId":"usedOnlyAsType","endLine":14,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\n\nconst TOAST_LIMIT = 1;\nconst TOAST_REMOVE_DELAY = 1000000;\n\ntype ToasterToast = {\n  id: string;\n  title?: React.ReactNode;\n  description?: React.ReactNode;\n  action?: React.ReactElement;\n  variant?: \"default\" | \"destructive\";\n};\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const;\n\nlet count = 0;\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER;\n  return count.toString();\n}\n\ntype ActionType = typeof actionTypes;\n\ntype Action =\n  | {\n    type: ActionType[\"ADD_TOAST\"];\n    toast: ToasterToast;\n  }\n  | {\n    type: ActionType[\"UPDATE_TOAST\"];\n    toast: Partial<ToasterToast>;\n  }\n  | {\n    type: ActionType[\"DISMISS_TOAST\"];\n    toastId?: ToasterToast[\"id\"];\n  }\n  | {\n    type: ActionType[\"REMOVE_TOAST\"];\n    toastId?: ToasterToast[\"id\"];\n  };\n\ninterface State {\n  toasts: ToasterToast[];\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return;\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId);\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    });\n  }, TOAST_REMOVE_DELAY);\n\n  toastTimeouts.set(toastId, timeout);\n};\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      };\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      };\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action;\n\n      if (toastId) {\n        addToRemoveQueue(toastId);\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id);\n        });\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n              ...t,\n              open: false,\n            }\n            : t\n        ),\n      };\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        };\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      };\n  }\n};\n\nconst listeners: Array<(state: State) => void> = [];\n\nlet memoryState: State = { toasts: [] };\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action);\n  listeners.forEach((listener) => {\n    listener(memoryState);\n  });\n}\n\ntype Toast = Omit<ToasterToast, \"id\">;\n\nfunction toast({ ...props }: Toast) {\n  const id = genId();\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    });\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id });\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss();\n      },\n    },\n  });\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  };\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState);\n\n  React.useEffect(() => {\n    listeners.push(setState);\n    return () => {\n      const index = listeners.indexOf(setState);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    };\n  }, [state]);\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  };\n}\n\nexport { useToast, toast };","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\contexts\\AuthContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserProfile' is defined but never used.","line":3,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UserProfile"},"fix":{"range":[156,174],"text":""},"desc":"Remove unused variable \"UserProfile\"."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkUser'. Either include it or remove the dependency array.","line":51,"column":6,"nodeType":"ArrayExpression","endLine":51,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [checkUser]","fix":{"range":[1441,1443],"text":"[checkUser]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":171,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":171,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useLocation } from 'wouter';\nimport { supabase, isSupabaseConfigured, type UserProfile } from '../lib/supabase';\n\ninterface User {\n  id: string;\n  name: string;\n  email: string;\n  avatar?: string;\n  bio?: string;\n  subscriptionTier?: 'free' | 'platinum';\n}\n\ninterface AuthContextType {\n  user: User | null;\n  loading: boolean;\n  login: () => void;\n  logout: () => void;\n  updateProfile: (data: Partial<User>) => void;\n  isAuthenticated: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    // Only proceed if Supabase is properly configured\n    if (!isSupabaseConfigured() || !supabase) {\n      setLoading(false);\n      return;\n    }\n\n    // Check for existing session\n    checkUser();\n    \n    // Listen for auth changes\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, session) => {\n      if (event === 'SIGNED_IN' && session) {\n        await loadUserProfile(session.user.id);\n      } else if (event === 'SIGNED_OUT') {\n        setUser(null);\n      }\n      setLoading(false);\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const checkUser = async () => {\n    if (!supabase) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session) {\n        await loadUserProfile(session.user.id);\n      }\n    } catch (error) {\n      console.error('Error checking user:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadUserProfile = async (userId: string) => {\n    if (!supabase) return;\n\n    try {\n      const { data: profile } = await supabase\n        .from('user_profiles')\n        .select('*')\n        .eq('id', userId)\n        .single();\n\n      if (profile) {\n        setUser({\n          id: profile.id,\n          name: profile.display_name,\n          email: '', // Will be loaded from auth.users if needed\n          avatar: profile.avatar_url,\n          bio: profile.bio,\n          subscriptionTier: profile.subscription_tier\n        });\n      }\n    } catch (error) {\n      console.error('Error loading profile:', error);\n    }\n  };\n\n  const login = async () => {\n    setLoading(true);\n    \n    // For demo purposes, create a mock user and profile\n    try {\n      // In a real app, this would be handled by Supabase Auth\n      const mockUser = {\n        id: 'demo-user-' + Date.now(),\n        name: 'Demo User',\n        email: 'demo@itone.com',\n        avatar: 'https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=128&h=128&fit=crop',\n        bio: 'Passionate karaoke singer and music lover ðŸŽ¤',\n        subscriptionTier: 'free' as const\n      };\n\n      // Simulate creating profile in database\n      setTimeout(() => {\n        setUser(mockUser);\n        setLoading(false);\n        setLocation('/dashboard');\n      }, 1000);\n    } catch (error) {\n      console.error('Login error:', error);\n      setLoading(false);\n    }\n  };\n\n  const logout = async () => {\n    if (!supabase) {\n      setUser(null);\n      setLocation('/');\n      return;\n    }\n\n    try {\n      await supabase.auth.signOut();\n      setUser(null);\n      setLocation('/');\n    } catch (error) {\n      console.error('Logout error:', error);\n    }\n  };\n\n  const updateProfile = async (data: Partial<User>) => {\n    if (!user) return;\n\n    try {\n      const updatedUser = { ...user, ...data };\n      setUser(updatedUser);\n\n      // In a real app, update the database\n      // await supabase.from('user_profiles').update({\n      //   display_name: updatedUser.name,\n      //   bio: updatedUser.bio,\n      //   avatar_url: updatedUser.avatar\n      // }).eq('id', user.id);\n    } catch (error) {\n      console.error('Profile update error:', error);\n    }\n  };\n\n  return (\n    <AuthContext.Provider value={{ \n      user, \n      loading, \n      login, \n      logout, \n      updateProfile,\n      isAuthenticated: !!user \n    }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\hooks\\useAudioEffects.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[961,964],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[961,964],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useCallback, useEffect } from 'react';\n\ninterface AudioEffectsConfig {\n  autoTune: boolean;\n  reverb: number; // 0-100\n  echo: number; // 0-100\n  pitch: number; // -12 to +12 semitones\n  volume: number; // 0-100\n}\n\nexport function useAudioEffects() {\n  const [config, setConfig] = useState<AudioEffectsConfig>({\n    autoTune: false,\n    reverb: 0,\n    echo: 0,\n    pitch: 0,\n    volume: 80\n  });\n\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const sourceNodeRef = useRef<MediaStreamAudioSourceNode | null>(null);\n  const gainNodeRef = useRef<GainNode | null>(null);\n  const reverbNodeRef = useRef<ConvolverNode | null>(null);\n  const delayNodeRef = useRef<DelayNode | null>(null);\n  const pitchShifterRef = useRef<ScriptProcessorNode | null>(null);\n\n  const initializeAudioContext = useCallback(async () => {\n    if (!audioContextRef.current) {\n      audioContextRef.current = new (window.AudioContext || (window as any).webkitAudioContext)();\n    }\n\n    if (audioContextRef.current.state === 'suspended') {\n      await audioContextRef.current.resume();\n    }\n\n    return audioContextRef.current;\n  }, []);\n\n  const createReverbImpulse = useCallback((audioContext: AudioContext, duration: number, decay: number) => {\n    const sampleRate = audioContext.sampleRate;\n    const length = sampleRate * duration;\n    const impulse = audioContext.createBuffer(2, length, sampleRate);\n\n    for (let channel = 0; channel < 2; channel++) {\n      const channelData = impulse.getChannelData(channel);\n      for (let i = 0; i < length; i++) {\n        const n = length - i;\n        channelData[i] = (Math.random() * 2 - 1) * Math.pow(n / length, decay);\n      }\n    }\n\n    return impulse;\n  }, []);\n\n  const applyEffects = useCallback(async (inputStream: MediaStream): Promise<MediaStream> => {\n    const audioContext = await initializeAudioContext();\n    \n    // Create audio nodes\n    const sourceNode = audioContext.createMediaStreamSource(inputStream);\n    const gainNode = audioContext.createGain();\n    const reverbNode = audioContext.createConvolver();\n    const delayNode = audioContext.createDelay(1.0);\n    const delayGainNode = audioContext.createGain();\n    const outputNode = audioContext.createMediaStreamDestination();\n\n    // Store references\n    sourceNodeRef.current = sourceNode;\n    gainNodeRef.current = gainNode;\n    reverbNodeRef.current = reverbNode;\n    delayNodeRef.current = delayNode;\n\n    // Configure gain (volume)\n    gainNode.gain.value = config.volume / 100;\n\n    // Configure reverb\n    if (config.reverb > 0) {\n      const reverbImpulse = createReverbImpulse(audioContext, 2, 2);\n      reverbNode.buffer = reverbImpulse;\n      \n      const reverbGainNode = audioContext.createGain();\n      reverbGainNode.gain.value = config.reverb / 100;\n      \n      sourceNode.connect(reverbNode);\n      reverbNode.connect(reverbGainNode);\n      reverbGainNode.connect(outputNode);\n    }\n\n    // Configure echo/delay\n    if (config.echo > 0) {\n      delayNode.delayTime.value = 0.3; // 300ms delay\n      delayGainNode.gain.value = config.echo / 100;\n      \n      sourceNode.connect(delayNode);\n      delayNode.connect(delayGainNode);\n      delayGainNode.connect(outputNode);\n    }\n\n    // Connect main audio path\n    sourceNode.connect(gainNode);\n    gainNode.connect(outputNode);\n\n    return outputNode.stream;\n  }, [config, initializeAudioContext, createReverbImpulse]);\n\n  const updateConfig = useCallback((newConfig: Partial<AudioEffectsConfig>) => {\n    setConfig(prev => ({ ...prev, ...newConfig }));\n  }, []);\n\n  const updateVolume = useCallback((volume: number) => {\n    setConfig(prev => ({ ...prev, volume }));\n    if (gainNodeRef.current) {\n      gainNodeRef.current.gain.value = volume / 100;\n    }\n  }, []);\n\n  const updateReverb = useCallback((reverb: number) => {\n    setConfig(prev => ({ ...prev, reverb }));\n    // Reverb changes require reconnecting the audio graph\n  }, []);\n\n  const updateEcho = useCallback((echo: number) => {\n    setConfig(prev => ({ ...prev, echo }));\n    // Echo changes require reconnecting the audio graph\n  }, []);\n\n  const updatePitch = useCallback((pitch: number) => {\n    setConfig(prev => ({ ...prev, pitch }));\n    // Pitch shifting is complex and would require additional libraries\n    // For now, this is a placeholder for future implementation\n  }, []);\n\n  const toggleAutoTune = useCallback(() => {\n    setConfig(prev => ({ ...prev, autoTune: !prev.autoTune }));\n    // Auto-tune implementation would require pitch detection and correction\n  }, []);\n\n  const cleanup = useCallback(() => {\n    if (audioContextRef.current) {\n      audioContextRef.current.close();\n      audioContextRef.current = null;\n    }\n    \n    sourceNodeRef.current = null;\n    gainNodeRef.current = null;\n    reverbNodeRef.current = null;\n    delayNodeRef.current = null;\n    pitchShifterRef.current = null;\n  }, []);\n\n  useEffect(() => {\n    return cleanup;\n  }, [cleanup]);\n\n  return {\n    config,\n    updateConfig,\n    updateVolume,\n    updateReverb,\n    updateEcho,\n    updatePitch,\n    toggleAutoTune,\n    applyEffects,\n    cleanup\n  };\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\hooks\\useAudioRecording.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\hooks\\usePlatinum.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":184,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":184,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4911,4914],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4911,4914],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase, isSupabaseConfigured } from '../lib/supabase';\nimport type { \n  StreamingPlatform, \n  UserPlatformConnection, \n  PlatinumSubscription, \n  UploadJob,\n  PlatinumPricing \n} from '../types/platinum';\n\n// Streaming Platforms\nexport function useStreamingPlatforms() {\n  return useQuery({\n    queryKey: ['streamingPlatforms'],\n    queryFn: async () => {\n      if (!supabase || !isSupabaseConfigured()) {\n        // Return mock data when Supabase is not configured\n        return [\n          {\n            id: '1',\n            name: 'spotify',\n            display_name: 'Spotify',\n            api_base_cost: 4.99,\n            oauth_config: {},\n            upload_requirements: {},\n            is_active: true,\n            created_at: new Date().toISOString()\n          },\n          {\n            id: '2',\n            name: 'amazon_music',\n            display_name: 'Amazon Music',\n            api_base_cost: 3.99,\n            oauth_config: {},\n            upload_requirements: {},\n            is_active: true,\n            created_at: new Date().toISOString()\n          }\n        ] as StreamingPlatform[];\n      }\n\n      const { data, error } = await supabase\n        .from('streaming_platforms')\n        .select('*')\n        .eq('is_active', true)\n        .order('display_name');\n      \n      if (error) throw error;\n      return data as StreamingPlatform[];\n    }\n  });\n}\n\n// User Platform Connections\nexport function useUserPlatformConnections(userId?: string) {\n  return useQuery({\n    queryKey: ['userPlatformConnections', userId],\n    queryFn: async () => {\n      if (!userId || !supabase || !isSupabaseConfigured()) return [];\n      \n      const { data, error } = await supabase\n        .from('user_platform_connections')\n        .select(`\n          *,\n          platform:streaming_platforms(*)\n        `)\n        .eq('user_id', userId)\n        .order('created_at', { ascending: false });\n      \n      if (error) throw error;\n      return data as UserPlatformConnection[];\n    },\n    enabled: !!userId\n  });\n}\n\n// Platinum Subscription\nexport function usePlatinumSubscription(userId?: string) {\n  return useQuery({\n    queryKey: ['platinumSubscription', userId],\n    queryFn: async () => {\n      if (!userId || !supabase || !isSupabaseConfigured()) return null;\n      \n      const { data, error } = await supabase\n        .from('platinum_subscriptions')\n        .select('*')\n        .eq('user_id', userId)\n        .eq('status', 'active')\n        .single();\n      \n      if (error && error.code !== 'PGRST116') throw error;\n      return data as PlatinumSubscription | null;\n    },\n    enabled: !!userId\n  });\n}\n\n// Calculate Platinum Pricing\nexport function usePlatinumPricing() {\n  return useQuery({\n    queryKey: ['platinumPricing'],\n    queryFn: async () => {\n      if (!supabase || !isSupabaseConfigured()) {\n        // Return mock pricing when Supabase is not configured\n        return {\n          base_cost: 29.99,\n          platform_costs: 15.00,\n          itone_margin: 9.00,\n          total_cost: 53.99\n        } as PlatinumPricing;\n      }\n\n      const { data, error } = await supabase\n        .rpc('calculate_platinum_pricing');\n      \n      if (error) throw error;\n      return data[0] as PlatinumPricing;\n    }\n  });\n}\n\n// Connect Platform\nexport function useConnectPlatform() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ \n      userId, \n      platformId, \n      accessToken, \n      refreshToken, \n      expiresAt,\n      platformUserId,\n      platformUsername \n    }: {\n      userId: string;\n      platformId: string;\n      accessToken: string;\n      refreshToken: string;\n      expiresAt: string;\n      platformUserId: string;\n      platformUsername: string;\n    }) => {\n      if (!supabase) throw new Error('Supabase not configured');\n      \n      const { data, error } = await supabase\n        .from('user_platform_connections')\n        .upsert({\n          user_id: userId,\n          platform_id: platformId,\n          access_token: accessToken,\n          refresh_token: refreshToken,\n          token_expires_at: expiresAt,\n          platform_user_id: platformUserId,\n          platform_username: platformUsername,\n          connection_status: 'active'\n        })\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['userPlatformConnections', variables.userId] });\n    }\n  });\n}\n\n// Create Upload Job\nexport function useCreateUploadJob() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ \n      userId, \n      recordingId, \n      platformIds,\n      metadata \n    }: {\n      userId: string;\n      recordingId: string;\n      platformIds: string[];\n      metadata: Record<string, any>;\n    }) => {\n      if (!supabase) throw new Error('Supabase not configured');\n      \n      const jobs = platformIds.map(platformId => ({\n        user_id: userId,\n        recording_id: recordingId,\n        platform_id: platformId,\n        metadata\n      }));\n\n      const { data, error } = await supabase\n        .from('upload_jobs')\n        .insert(jobs)\n        .select(`\n          *,\n          platform:streaming_platforms(*)\n        `);\n      \n      if (error) throw error;\n      return data as UploadJob[];\n    },\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['uploadJobs', variables.userId] });\n    }\n  });\n}\n\n// Get Upload Jobs\nexport function useUploadJobs(userId?: string) {\n  return useQuery({\n    queryKey: ['uploadJobs', userId],\n    queryFn: async () => {\n      if (!userId || !supabase) return [];\n      \n      const { data, error } = await supabase\n        .from('upload_jobs')\n        .select(`\n          *,\n          platform:streaming_platforms(*),\n          recording:recordings(*)\n        `)\n        .eq('user_id', userId)\n        .order('created_at', { ascending: false });\n      \n      if (error) throw error;\n      return data as UploadJob[];\n    },\n    enabled: !!userId\n  });\n}\n\n// Create Platinum Subscription\nexport function useCreatePlatinumSubscription() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ \n      userId, \n      stripeSubscriptionId,\n      pricing \n    }: {\n      userId: string;\n      stripeSubscriptionId: string;\n      pricing: PlatinumPricing;\n    }) => {\n      if (!supabase) throw new Error('Supabase not configured');\n      \n      const { data, error } = await supabase\n        .from('platinum_subscriptions')\n        .insert({\n          user_id: userId,\n          stripe_subscription_id: stripeSubscriptionId,\n          base_subscription_cost: pricing.base_cost,\n          platform_access_cost: pricing.platform_costs,\n          itone_margin: pricing.itone_margin,\n          total_monthly_cost: pricing.total_cost,\n          upload_credits_remaining: 10, // 10 uploads per month included\n          status: 'trialing'\n        })\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['platinumSubscription', variables.userId] });\n    }\n  });\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\hooks\\useSubscription.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\hooks\\useSupabase.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useAuth' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":17,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useAuth"},"fix":{"range":[210,260],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase, type UserProfile, type Song, type UserSong, type Recording, type CollaborativeSession } from '../lib/supabase';\nimport { useAuth } from '../contexts/AuthContext';\n\n// Mock data for demo when Supabase is not configured\nconst mockSongs = [\n  {\n    id: '1',\n    title: 'Bohemian Rhapsody',\n    artist: 'Queen',\n    duration: 355,\n    genre: 'Rock',\n    difficulty: 'hard',\n    youtube_url: 'https://www.youtube.com/watch?v=fJ9rUzIMcZQ',\n    spotify_id: '4u7EnebtmKWzUH433cf1Qv',\n    created_at: new Date().toISOString()\n  },\n  {\n    id: '2',\n    title: 'Shape of You',\n    artist: 'Ed Sheeran',\n    duration: 233,\n    genre: 'Pop',\n    difficulty: 'medium',\n    youtube_url: 'https://www.youtube.com/watch?v=JGwWNGJdvx8',\n    spotify_id: '7qiZfU4dY4WkLyMn4s5iuJ',\n    created_at: new Date().toISOString()\n  },\n  {\n    id: '3',\n    title: 'Imagine',\n    artist: 'John Lennon',\n    duration: 183,\n    genre: 'Classic',\n    difficulty: 'easy',\n    youtube_url: 'https://www.youtube.com/watch?v=YkgkThdzX-8',\n    spotify_id: '7pKfPomDiuM2OtqtWKpGRb',\n    created_at: new Date().toISOString()\n  }\n];\n\n// User Profile Hooks\nexport function useUserProfile(userId?: string) {\n  return useQuery({\n    queryKey: ['userProfile', userId],\n    queryFn: async () => {\n      if (!supabase || !userId) return null;\n      \n      const { data, error } = await supabase\n        .from('user_profiles')\n        .select('*')\n        .eq('id', userId)\n        .single();\n      \n      if (error) throw error;\n      return data as UserProfile;\n    },\n    enabled: !!userId\n  });\n}\n\nexport function useUpdateProfile() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async (profile: Partial<UserProfile> & { id: string }) => {\n      if (!supabase) throw new Error('Supabase not configured');\n      \n      const { data, error } = await supabase\n        .from('user_profiles')\n        .update(profile)\n        .eq('id', profile.id)\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['userProfile', data.id] });\n    }\n  });\n}\n\n// Songs Hooks\nexport function useSongs(search?: string, genre?: string) {\n  return useQuery({\n    queryKey: ['songs', search, genre],\n    queryFn: async () => {\n      if (!supabase) {\n        // Return filtered mock data\n        let filtered = mockSongs;\n        if (search) {\n          const searchTerm = search.toLowerCase();\n          filtered = filtered.filter(song => \n            song.title.toLowerCase().includes(searchTerm) ||\n            song.artist.toLowerCase().includes(searchTerm)\n          );\n        }\n        if (genre) {\n          filtered = filtered.filter(song => song.genre === genre);\n        }\n        return filtered as Song[];\n      }\n      \n      let query = supabase.from('songs').select('*');\n      \n      if (search) {\n        query = query.or(`title.ilike.%${search}%,artist.ilike.%${search}%`);\n      }\n      \n      if (genre) {\n        query = query.eq('genre', genre);\n      }\n      \n      const { data, error } = await query.order('title');\n      if (error) throw error;\n      return data as Song[];\n    }\n  });\n}\n\n// User Songs Hooks\nexport function useUserSongs(userId?: string) {\n  return useQuery({\n    queryKey: ['userSongs', userId],\n    queryFn: async () => {\n      if (!supabase || !userId) return [];\n      \n      const { data, error } = await supabase\n        .from('user_songs')\n        .select(`\n          *,\n          song:songs(*)\n        `)\n        .eq('user_id', userId)\n        .order('created_at', { ascending: false });\n      \n      if (error) throw error;\n      return data as UserSong[];\n    },\n    enabled: !!userId\n  });\n}\n\nexport function useSaveSong() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ userId, songId, transposeValue = 0, notes = '' }: {\n      userId: string;\n      songId: string;\n      transposeValue?: number;\n      notes?: string;\n    }) => {\n      if (!supabase) {\n        // Mock save for demo\n        return { id: Date.now().toString(), user_id: userId, song_id: songId, transpose_value: transposeValue, notes };\n      }\n      \n      const { data, error } = await supabase\n        .from('user_songs')\n        .insert({\n          user_id: userId,\n          song_id: songId,\n          transpose_value: transposeValue,\n          notes\n        })\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['userSongs', variables.userId] });\n    }\n  });\n}\n\nexport function useRemoveSong() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ userId, songId }: { userId: string; songId: string }) => {\n      if (!supabase) {\n        // Mock remove for demo\n        return;\n      }\n      \n      const { error } = await supabase\n        .from('user_songs')\n        .delete()\n        .eq('user_id', userId)\n        .eq('song_id', songId);\n      \n      if (error) throw error;\n    },\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['userSongs', variables.userId] });\n    }\n  });\n}\n\n// Recordings Hooks\nexport function useUserRecordings(userId?: string) {\n  return useQuery({\n    queryKey: ['recordings', userId],\n    queryFn: async () => {\n      if (!supabase || !userId) return [];\n      \n      const { data, error } = await supabase\n        .from('recordings')\n        .select(`\n          *,\n          song:songs(*)\n        `)\n        .eq('user_id', userId)\n        .order('created_at', { ascending: false });\n      \n      if (error) throw error;\n      return data as Recording[];\n    },\n    enabled: !!userId\n  });\n}\n\nexport function useSaveRecording() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async (recording: Omit<Recording, 'id' | 'created_at' | 'song'>) => {\n      if (!supabase) {\n        // Mock save for demo\n        return { id: Date.now().toString(), ...recording, created_at: new Date().toISOString() };\n      }\n      \n      const { data, error } = await supabase\n        .from('recordings')\n        .insert(recording)\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return data;\n    },\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['recordings', variables.user_id] });\n    }\n  });\n}\n\n// Collaborative Sessions Hooks\nexport function useActiveSessions() {\n  return useQuery({\n    queryKey: ['activeSessions'],\n    queryFn: async () => {\n      if (!supabase) return [];\n      \n      const { data, error } = await supabase\n        .from('collaborative_sessions')\n        .select(`\n          *,\n          song:songs(*),\n          host:user_profiles(*)\n        `)\n        .eq('is_active', true)\n        .order('created_at', { ascending: false });\n      \n      if (error) throw error;\n      return data as CollaborativeSession[];\n    }\n  });\n}\n\nexport function useCreateSession() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ hostId, songId, maxParticipants = 4 }: {\n      hostId: string;\n      songId?: string;\n      maxParticipants?: number;\n    }) => {\n      if (!supabase) {\n        // Mock session for demo\n        return {\n          id: Date.now().toString(),\n          host_id: hostId,\n          session_code: Math.random().toString(36).substring(2, 10).toUpperCase(),\n          song_id: songId,\n          max_participants: maxParticipants,\n          is_active: true,\n          created_at: new Date().toISOString()\n        };\n      }\n      \n      // Generate unique session code\n      const sessionCode = Math.random().toString(36).substring(2, 10).toUpperCase();\n      \n      const { data, error } = await supabase\n        .from('collaborative_sessions')\n        .insert({\n          host_id: hostId,\n          session_code: sessionCode,\n          song_id: songId,\n          max_participants: maxParticipants\n        })\n        .select()\n        .single();\n      \n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['activeSessions'] });\n    }\n  });\n}\n\n// Subscription Hooks\nexport function useUserSubscription(userId?: string) {\n  return useQuery({\n    queryKey: ['subscription', userId],\n    queryFn: async () => {\n      if (!supabase || !userId) return null;\n      \n      const { data, error } = await supabase\n        .from('subscriptions')\n        .select('*')\n        .eq('user_id', userId)\n        .eq('status', 'active')\n        .single();\n      \n      if (error && error.code !== 'PGRST116') throw error;\n      return data as Subscription | null;\n    },\n    enabled: !!userId\n  });\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\hooks\\useWebRTC.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\lib\\stripe.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[688,691],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[688,691],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { loadStripe } from '@stripe/stripe-js';\n\n// Initialize Stripe with publishable key\nconst stripePromise = loadStripe(import.meta.env.VITE_STRIPE_PUBLISHABLE_KEY || 'pk_test_demo');\n\nexport { stripePromise };\n\n// Stripe configuration\nexport const stripeConfig = {\n  publishableKey: import.meta.env.VITE_STRIPE_PUBLISHABLE_KEY || 'pk_test_demo',\n  // In production, these would be loaded from environment variables\n  priceIds: {\n    silver: 'price_silver_monthly',\n    gold: 'price_gold_monthly', \n    platinum: 'price_platinum_monthly'\n  }\n};\n\n// Helper function to create checkout session\nexport async function createCheckoutSession(priceId: string, customerId?: string, options?: any) {\n  try {\n    const response = await fetch('/api/create-checkout-session', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        priceId,\n        customerId,\n        ...options,\n        successUrl: `${window.location.origin}/dashboard?session_id={CHECKOUT_SESSION_ID}`,\n        cancelUrl: `${window.location.origin}/pricing`\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to create checkout session');\n    }\n\n    const { sessionId } = await response.json();\n    return sessionId;\n  } catch (error) {\n    console.error('Error creating checkout session:', error);\n    throw error;\n  }\n}\n\n// Helper function to redirect to Stripe Checkout\nexport async function redirectToCheckout(sessionId: string) {\n  const stripe = await stripePromise;\n  if (!stripe) {\n    throw new Error('Stripe failed to load');\n  }\n\n  const { error } = await stripe.redirectToCheckout({ sessionId });\n  if (error) {\n    throw error;\n  }\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\pages\\BillingPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\pages\\DashboardPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_platinumSubscription' is assigned a value but never used.","line":23,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":38}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useLocation } from 'wouter';\nimport { SongLibrary } from '../components/SongLibrary';\nimport { Queue } from '../components/Queue';\nimport { UserProfile } from '../components/UserProfile';\nimport { RecordingStudio } from '../components/RecordingStudio';\nimport { CollaborativeSession } from '../components/CollaborativeSession';\nimport { PlatformConnectionManager } from '../components/PlatformConnectionManager';\nimport { UploadDashboard } from '../components/UploadDashboard';\nimport { FeatureGate } from '../components/FeatureGate';\nimport { Header } from '../components/Header';\nimport { useUserSubscription } from '../hooks/useSubscription';\nimport { usePlatinumSubscription } from '../hooks/usePlatinum';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../components/ui/tabs';\nimport { Button } from '../components/ui/button';\nimport { Music, Clock, Mic, User, Video, Users, Crown, CreditCard, Upload, Link2, Star } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport function DashboardPage() {\n  const { user, loading } = useAuth();\n  const { data: subscription } = useUserSubscription(user?.id);\n  const { data: _platinumSubscription } = usePlatinumSubscription(user?.id);\n  const [, setLocation] = useLocation();\n\n  React.useEffect(() => {\n    if (!loading && !user) {\n      setLocation('/login');\n    }\n  }, [user, loading, setLocation]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-400\"></div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen\">\n      <Header />\n\n      <main className=\"max-w-7xl mx-auto px-6 py-8\">\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-4xl font-bold text-white mb-2 flex items-center\">\n                Welcome back, {user.name?.split(' ')[0]}! ðŸŽ¤\n                {subscription?.plan?.name === 'Platinum' && (\n                  <Crown className=\"h-8 w-8 text-yellow-400 ml-3\" />\n                )}\n              </h1>\n              <p className=\"text-gray-300 text-lg\">\n                Ready to show off your vocal skills?\n              </p>\n            </div>\n            {!subscription && (\n              <Link href=\"/pricing\">\n                <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\">\n                  <Crown className=\"h-4 w-4 mr-2\" />\n                  View Plans\n                </Button>\n              </Link>\n            )}\n          </div>\n        </div>\n\n        {/* Subscription Status Banner */}\n        {subscription ? (\n          <div className={`backdrop-blur-lg rounded-2xl p-4 mb-6 border ${subscription.plan?.name === 'Silver' ? 'bg-gradient-to-r from-gray-600/20 to-gray-500/20 border-gray-400/30' :\n            subscription.plan?.name === 'Gold' ? 'bg-gradient-to-r from-yellow-600/20 to-orange-600/20 border-yellow-400/30' :\n              'bg-gradient-to-r from-purple-600/20 to-pink-600/20 border-purple-400/30'\n            }`}>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-3\">\n                {subscription.plan?.name === 'Silver' && <Star className=\"h-6 w-6 text-gray-400\" />}\n                {subscription.plan?.name === 'Gold' && <Crown className=\"h-6 w-6 text-yellow-400\" />}\n                {subscription.plan?.name === 'Platinum' && <Crown className=\"h-6 w-6 text-purple-400\" />}\n                <div>\n                  <h3 className=\"text-white font-semibold\">{subscription.plan?.name} Member</h3>\n                  <p className=\"text-gray-300 text-sm\">\n                    {subscription.status === 'trialing' ? 'Free trial active' : 'Subscription active'} â€¢\n                    Renews {new Date(subscription.current_period_end).toLocaleDateString()}\n                  </p>\n                </div>\n              </div>\n              <Link href=\"/billing\">\n                <Button variant=\"outline\" className=\"border-white/20 text-white hover:bg-white/10\">\n                  <CreditCard className=\"h-4 w-4 mr-2\" />\n                  Manage\n                </Button>\n              </Link>\n            </div>\n          </div>\n        ) : (\n          <div className=\"bg-gradient-to-r from-purple-600/20 to-pink-600/20 backdrop-blur-lg rounded-2xl p-4 mb-6 border border-purple-400/30\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-3\">\n                <Crown className=\"h-6 w-6 text-purple-400\" />\n                <div>\n                  <h3 className=\"text-white font-semibold\">Unlock Premium Features</h3>\n                  <p className=\"text-gray-300 text-sm\">HD recording, collaboration, and platform uploads</p>\n                </div>\n              </div>\n              <Link href=\"/pricing\">\n                <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\">\n                  <Crown className=\"h-4 w-4 mr-2\" />\n                  View Plans\n                </Button>\n              </Link>\n            </div>\n          </div>\n        )}\n\n        <Tabs defaultValue=\"library\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-8 bg-white/10 backdrop-blur-lg p-1\">\n            <TabsTrigger value=\"profile\" className=\"data-[state=active]:bg-white/20\">\n              <User className=\"h-4 w-4 mr-2\" />\n              Profile\n            </TabsTrigger>\n            <TabsTrigger value=\"library\" className=\"data-[state=active]:bg-white/20\">\n              <Music className=\"h-4 w-4 mr-2\" />\n              Library\n            </TabsTrigger>\n            <TabsTrigger value=\"queue\" className=\"data-[state=active]:bg-white/20\">\n              <Clock className=\"h-4 w-4 mr-2\" />\n              Queue\n            </TabsTrigger>\n            <TabsTrigger value=\"record\" className=\"data-[state=active]:bg-white/20\">\n              <Video className=\"h-4 w-4 mr-2\" />\n              Record\n            </TabsTrigger>\n            <TabsTrigger value=\"collaborate\" className=\"data-[state=active]:bg-white/20\">\n              <Users className=\"h-4 w-4 mr-2\" />\n              Collaborate\n            </TabsTrigger>\n            <TabsTrigger value=\"platforms\" className=\"data-[state=active]:bg-white/20\">\n              <Link2 className=\"h-4 w-4 mr-2\" />\n              Platforms\n            </TabsTrigger>\n            <TabsTrigger value=\"uploads\" className=\"data-[state=active]:bg-white/20\">\n              <Upload className=\"h-4 w-4 mr-2\" />\n              Uploads\n            </TabsTrigger>\n            <TabsTrigger value=\"live\" className=\"data-[state=active]:bg-white/20\">\n              <Mic className=\"h-4 w-4 mr-2\" />\n              Live\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"profile\">\n            <UserProfile />\n          </TabsContent>\n\n          <TabsContent value=\"library\">\n            <SongLibrary />\n          </TabsContent>\n\n          <TabsContent value=\"queue\">\n            <Queue />\n          </TabsContent>\n\n          <TabsContent value=\"record\">\n            <FeatureGate feature=\"hd_recording\" requiredPlan=\"Silver\">\n              <RecordingStudio />\n            </FeatureGate>\n          </TabsContent>\n\n          <TabsContent value=\"collaborate\">\n            <FeatureGate feature=\"collaboration\" requiredPlan=\"Gold\">\n              <CollaborativeSession />\n            </FeatureGate>\n          </TabsContent>\n\n          <TabsContent value=\"platforms\">\n            <FeatureGate\n              feature=\"platform_uploads\"\n              requiredPlan=\"Platinum\"\n              fallback={\n                <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center\">\n                  <Crown className=\"h-16 w-16 text-purple-400 mx-auto mb-4\" />\n                  <h3 className=\"text-2xl font-bold text-white mb-4\">Platform Integration</h3>\n                  <p className=\"text-gray-300 mb-6\">\n                    Connect your streaming platform accounts and upload directly from iTone.\n                    All platform access costs are included in your Platinum subscription.\n                  </p>\n                  <Link href=\"/pricing\">\n                    <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-semibold px-8 py-3\">\n                      <Crown className=\"h-4 w-4 mr-2\" />\n                      Upgrade to Platinum\n                    </Button>\n                  </Link>\n                </div>\n              }\n            >\n              <PlatformConnectionManager />\n            </FeatureGate>\n          </TabsContent>\n\n          <TabsContent value=\"uploads\">\n            <FeatureGate\n              feature=\"platform_uploads\"\n              requiredPlan=\"Platinum\"\n              fallback={\n                <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center\">\n                  <Upload className=\"h-16 w-16 text-purple-400 mx-auto mb-4\" />\n                  <h3 className=\"text-2xl font-bold text-white mb-4\">Upload Dashboard</h3>\n                  <p className=\"text-gray-300 mb-6\">\n                    Track your uploads to streaming platforms and monitor your monthly usage.\n                    Get 10 uploads per month included with Platinum.\n                  </p>\n                  <Link href=\"/pricing\">\n                    <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-semibold px-8 py-3\">\n                      <Crown className=\"h-4 w-4 mr-2\" />\n                      Upgrade to Platinum\n                    </Button>\n                  </Link>\n                </div>\n              }\n            >\n              <UploadDashboard />\n            </FeatureGate>\n          </TabsContent>\n          <TabsContent value=\"live\">\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center\">\n              <Mic className=\"h-16 w-16 text-purple-400 mx-auto mb-4\" />\n              <h3 className=\"text-2xl font-bold text-white mb-4\">Live Karaoke Session</h3>\n              <p className=\"text-gray-300 mb-6\">\n                Join or start a live karaoke session with other singers\n              </p>\n              <div className=\"flex gap-4 justify-center\">\n                <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-6 py-3 rounded-full font-semibold transition-all duration-200 transform hover:scale-105\">\n                  Start Session\n                </Button>\n                <Button className=\"bg-white/10 border border-white/20 text-white hover:bg-white/20 px-6 py-3 rounded-full font-semibold transition-all duration-200\">\n                  Join Session\n                </Button>\n              </div>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </main>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\pages\\HomePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\pages\\KaraokePage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\pages\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\pages\\PricingPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\types\\audio.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\types\\collaboration.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1443,1446],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1443,1446],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":103,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2305,2308],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2305,2308],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface CollaborationRoom {\n  id: string;\n  name: string;\n  hostId: string;\n  sessionCode: string;\n  maxParticipants: number;\n  currentSong?: string;\n  isRecording: boolean;\n  isPublic: boolean;\n  createdAt: Date;\n  settings: RoomSettings;\n}\n\nexport interface RoomSettings {\n  allowSpectators: boolean;\n  requireApproval: boolean;\n  recordSeparateTracks: boolean;\n  autoMixing: boolean;\n  chatEnabled: boolean;\n  videoEnabled: boolean;\n  qualityLevel: 'standard' | 'high' | 'ultra';\n}\n\nexport interface Participant {\n  id: string;\n  userId: string;\n  name: string;\n  avatar?: string;\n  role: 'host' | 'singer' | 'spectator';\n  isOnline: boolean;\n  isMuted: boolean;\n  hasVideo: boolean;\n  joinedAt: Date;\n  permissions: ParticipantPermissions;\n}\n\nexport interface ParticipantPermissions {\n  canSing: boolean;\n  canRecord: boolean;\n  canControlPlayback: boolean;\n  canInviteOthers: boolean;\n  canKickParticipants: boolean;\n}\n\nexport interface ChatMessage {\n  id: string;\n  userId: string;\n  userName: string;\n  message: string;\n  timestamp: Date;\n  type: 'text' | 'system' | 'emoji' | 'reaction';\n  replyTo?: string;\n}\n\nexport interface VoiceActivity {\n  userId: string;\n  level: number; // 0-100\n  isSpeaking: boolean;\n  timestamp: Date;\n}\n\nexport interface CollaborationEvent {\n  id: string;\n  type: 'user_joined' | 'user_left' | 'song_changed' | 'recording_started' | 'recording_stopped' | 'chat_message';\n  userId: string;\n  data: any;\n  timestamp: Date;\n}\n\nexport interface SingingTurn {\n  userId: string;\n  startTime: Date;\n  endTime?: Date;\n  songSection?: {\n    startBar: number;\n    endBar: number;\n  };\n}\n\nexport interface CollaborationSession {\n  room: CollaborationRoom;\n  participants: Participant[];\n  currentTurn?: SingingTurn;\n  turnQueue: string[]; // User IDs in order\n  chatMessages: ChatMessage[];\n  voiceActivity: VoiceActivity[];\n  events: CollaborationEvent[];\n}\n\nexport interface WebRTCConnection {\n  participantId: string;\n  peerConnection: RTCPeerConnection;\n  localStream?: MediaStream;\n  remoteStream?: MediaStream;\n  dataChannel?: RTCDataChannel;\n  connectionState: RTCPeerConnectionState;\n}\n\nexport interface SignalingMessage {\n  type: 'offer' | 'answer' | 'ice-candidate' | 'join-room' | 'leave-room' | 'chat' | 'turn-change';\n  from: string;\n  to?: string;\n  data: any;\n  timestamp: Date;\n}\n\nexport interface CollaborationStats {\n  totalParticipants: number;\n  activeSingers: number;\n  recordingDuration: number;\n  messagesCount: number;\n  averageLatency: number;\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\types\\platinum.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1537,1540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1537,1540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface StreamingPlatform {\n  id: string;\n  name: 'spotify' | 'amazon_music' | 'apple_music' | 'youtube_music' | 'deezer';\n  display_name: string;\n  api_base_cost: number;\n  oauth_config: {\n    client_id: string;\n    scope: string;\n    redirect_uri: string;\n  };\n  upload_requirements: {\n    format: string;\n    min_duration: number;\n    max_duration: number;\n    sample_rate: number;\n  };\n  is_active: boolean;\n  created_at: string;\n}\n\nexport interface UserPlatformConnection {\n  id: string;\n  user_id: string;\n  platform_id: string;\n  access_token: string;\n  refresh_token: string;\n  token_expires_at: string;\n  platform_user_id: string;\n  platform_username: string;\n  connection_status: 'active' | 'expired' | 'revoked';\n  created_at: string;\n  updated_at: string;\n  platform?: StreamingPlatform;\n}\n\nexport interface PlatinumSubscription {\n  id: string;\n  user_id: string;\n  stripe_subscription_id: string;\n  base_subscription_cost: number;\n  platform_access_cost: number;\n  itone_margin: number;\n  total_monthly_cost: number;\n  upload_credits_remaining: number;\n  status: 'active' | 'cancelled' | 'expired' | 'past_due' | 'trialing';\n  current_period_start: string;\n  current_period_end: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface UploadJob {\n  id: string;\n  user_id: string;\n  recording_id?: string;\n  platform_id: string;\n  upload_status: 'pending' | 'processing' | 'completed' | 'failed';\n  platform_track_id?: string;\n  platform_url?: string;\n  cost_used: number;\n  metadata: Record<string, any>;\n  error_message?: string;\n  created_at: string;\n  completed_at?: string;\n  platform?: StreamingPlatform;\n}\n\nexport interface CostTracking {\n  id: string;\n  user_id: string;\n  month_year: string;\n  estimated_costs: number;\n  actual_costs: number;\n  profit_margin: number;\n  upload_count: number;\n  created_at: string;\n}\n\nexport interface PlatinumPricing {\n  base_cost: number;\n  platform_costs: number;\n  itone_margin: number;\n  total_cost: number;\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\types\\subscription.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\utils\\audioUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[509,512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[509,512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Audio utility functions for karaoke application\n */\n\nexport interface AudioAnalysis {\n  pitch: number;\n  volume: number;\n  frequency: number;\n}\n\nexport class AudioAnalyzer {\n  private audioContext: AudioContext | null = null;\n  private analyser: AnalyserNode | null = null;\n  private dataArray: Uint8Array | null = null;\n  private source: MediaStreamAudioSourceNode | null = null;\n\n  async initialize(stream: MediaStream): Promise<void> {\n    this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n    this.analyser = this.audioContext.createAnalyser();\n    this.source = this.audioContext.createMediaStreamSource(stream);\n    \n    this.analyser.fftSize = 2048;\n    this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n    \n    this.source.connect(this.analyser);\n  }\n\n  getAudioAnalysis(): AudioAnalysis {\n    if (!this.analyser || !this.dataArray) {\n      return { pitch: 0, volume: 0, frequency: 0 };\n    }\n\n    this.analyser.getByteFrequencyData(this.dataArray);\n    \n    // Calculate volume (RMS)\n    let sum = 0;\n    for (let i = 0; i < this.dataArray.length; i++) {\n      sum += this.dataArray[i] * this.dataArray[i];\n    }\n    const volume = Math.sqrt(sum / this.dataArray.length) / 255;\n\n    // Find dominant frequency (simplified pitch detection)\n    let maxIndex = 0;\n    let maxValue = 0;\n    for (let i = 0; i < this.dataArray.length; i++) {\n      if (this.dataArray[i] > maxValue) {\n        maxValue = this.dataArray[i];\n        maxIndex = i;\n      }\n    }\n\n    const frequency = (maxIndex * this.audioContext!.sampleRate) / (this.analyser.fftSize * 2);\n    const pitch = this.frequencyToPitch(frequency);\n\n    return { pitch, volume, frequency };\n  }\n\n  private frequencyToPitch(frequency: number): number {\n    // Convert frequency to MIDI note number\n    if (frequency <= 0) return 0;\n    return 12 * Math.log2(frequency / 440) + 69;\n  }\n\n  cleanup(): void {\n    if (this.source) {\n      this.source.disconnect();\n      this.source = null;\n    }\n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n    this.analyser = null;\n    this.dataArray = null;\n  }\n}\n\nexport function formatDuration(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n}\n\nexport function semitoneToFrequencyRatio(semitones: number): number {\n  return Math.pow(2, semitones / 12);\n}\n\nexport function createAudioBuffer(audioContext: AudioContext, duration: number): AudioBuffer {\n  const sampleRate = audioContext.sampleRate;\n  const frameCount = sampleRate * duration;\n  return audioContext.createBuffer(1, frameCount, sampleRate);\n}\n\nexport function applyFadeIn(audioBuffer: AudioBuffer, fadeTime: number): void {\n  const sampleRate = audioBuffer.sampleRate;\n  const fadeSamples = Math.floor(fadeTime * sampleRate);\n  \n  for (let channel = 0; channel < audioBuffer.numberOfChannels; channel++) {\n    const channelData = audioBuffer.getChannelData(channel);\n    for (let i = 0; i < fadeSamples && i < channelData.length; i++) {\n      channelData[i] *= i / fadeSamples;\n    }\n  }\n}\n\nexport function applyFadeOut(audioBuffer: AudioBuffer, fadeTime: number): void {\n  const sampleRate = audioBuffer.sampleRate;\n  const fadeSamples = Math.floor(fadeTime * sampleRate);\n  const startSample = audioBuffer.length - fadeSamples;\n  \n  for (let channel = 0; channel < audioBuffer.numberOfChannels; channel++) {\n    const channelData = audioBuffer.getChannelData(channel);\n    for (let i = 0; i < fadeSamples && startSample + i < channelData.length; i++) {\n      channelData[startSample + i] *= (fadeSamples - i) / fadeSamples;\n    }\n  }\n}\n\nexport class PitchShifter {\n  private audioContext: AudioContext;\n  private scriptProcessor: ScriptProcessorNode;\n  private pitchRatio: number = 1.0;\n\n  constructor(audioContext: AudioContext) {\n    this.audioContext = audioContext;\n    this.scriptProcessor = audioContext.createScriptProcessor(4096, 1, 1);\n    this.setupProcessor();\n  }\n\n  private setupProcessor(): void {\n    this.scriptProcessor.onaudioprocess = (event) => {\n      const inputBuffer = event.inputBuffer;\n      const outputBuffer = event.outputBuffer;\n      \n      // Simple pitch shifting using time-domain approach\n      // Note: This is a basic implementation. Professional pitch shifting\n      // would use more sophisticated algorithms like PSOLA or phase vocoder\n      \n      const inputData = inputBuffer.getChannelData(0);\n      const outputData = outputBuffer.getChannelData(0);\n      \n      for (let i = 0; i < outputData.length; i++) {\n        const sourceIndex = Math.floor(i / this.pitchRatio);\n        if (sourceIndex < inputData.length) {\n          outputData[i] = inputData[sourceIndex];\n        } else {\n          outputData[i] = 0;\n        }\n      }\n    };\n  }\n\n  setPitchRatio(ratio: number): void {\n    this.pitchRatio = Math.max(0.5, Math.min(2.0, ratio));\n  }\n\n  setPitchSemitones(semitones: number): void {\n    this.pitchRatio = semitoneToFrequencyRatio(semitones);\n  }\n\n  connect(destination: AudioNode): void {\n    this.scriptProcessor.connect(destination);\n  }\n\n  disconnect(): void {\n    this.scriptProcessor.disconnect();\n  }\n\n  getNode(): ScriptProcessorNode {\n    return this.scriptProcessor;\n  }\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\utils\\platformUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\utils\\videoUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_audioBlob' is defined but never used.","line":287,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":287,"endColumn":66}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Video utility functions for karaoke recording\n */\n\nexport interface VideoConstraints {\n  width?: number;\n  height?: number;\n  frameRate?: number;\n  facingMode?: 'user' | 'environment';\n}\n\nexport interface RecordingOptions {\n  videoBitsPerSecond?: number;\n  audioBitsPerSecond?: number;\n  mimeType?: string;\n}\n\nexport class VideoRecorder {\n  private mediaRecorder: MediaRecorder | null = null;\n  private recordedChunks: BlobPart[] = [];\n  private stream: MediaStream | null = null;\n\n  async initializeCamera(constraints: VideoConstraints = {}): Promise<MediaStream> {\n    const defaultConstraints: MediaStreamConstraints = {\n      video: {\n        width: { ideal: constraints.width || 1280 },\n        height: { ideal: constraints.height || 720 },\n        frameRate: { ideal: constraints.frameRate || 30 },\n        facingMode: constraints.facingMode || 'user'\n      },\n      audio: {\n        echoCancellation: true,\n        noiseSuppression: true,\n        autoGainControl: true,\n        sampleRate: 48000\n      }\n    };\n\n    try {\n      this.stream = await navigator.mediaDevices.getUserMedia(defaultConstraints);\n      return this.stream;\n    } catch (error) {\n      console.error('Error accessing camera:', error);\n      throw new Error('Camera access denied or not available');\n    }\n  }\n\n  startRecording(options: RecordingOptions = {}): void {\n    if (!this.stream) {\n      throw new Error('No media stream available. Initialize camera first.');\n    }\n\n    const defaultOptions = {\n      videoBitsPerSecond: options.videoBitsPerSecond || 2500000, // 2.5 Mbps\n      audioBitsPerSecond: options.audioBitsPerSecond || 128000,  // 128 kbps\n      mimeType: options.mimeType || 'video/webm;codecs=vp9,opus'\n    };\n\n    // Fallback to supported mime type\n    let mimeType = defaultOptions.mimeType;\n    if (!MediaRecorder.isTypeSupported(mimeType)) {\n      mimeType = 'video/webm;codecs=vp8,opus';\n      if (!MediaRecorder.isTypeSupported(mimeType)) {\n        mimeType = 'video/webm';\n      }\n    }\n\n    this.mediaRecorder = new MediaRecorder(this.stream, {\n      mimeType,\n      videoBitsPerSecond: defaultOptions.videoBitsPerSecond,\n      audioBitsPerSecond: defaultOptions.audioBitsPerSecond\n    });\n\n    this.recordedChunks = [];\n\n    this.mediaRecorder.ondataavailable = (event) => {\n      if (event.data.size > 0) {\n        this.recordedChunks.push(event.data);\n      }\n    };\n\n    this.mediaRecorder.start(100); // Collect data every 100ms\n  }\n\n  stopRecording(): Promise<Blob> {\n    return new Promise((resolve, reject) => {\n      if (!this.mediaRecorder) {\n        reject(new Error('No active recording'));\n        return;\n      }\n\n      this.mediaRecorder.onstop = () => {\n        const blob = new Blob(this.recordedChunks, {\n          type: this.mediaRecorder?.mimeType || 'video/webm'\n        });\n        resolve(blob);\n      };\n\n      this.mediaRecorder.stop();\n    });\n  }\n\n  pauseRecording(): void {\n    if (this.mediaRecorder && this.mediaRecorder.state === 'recording') {\n      this.mediaRecorder.pause();\n    }\n  }\n\n  resumeRecording(): void {\n    if (this.mediaRecorder && this.mediaRecorder.state === 'paused') {\n      this.mediaRecorder.resume();\n    }\n  }\n\n  getRecordingState(): RecordingState {\n    return this.mediaRecorder?.state || 'inactive';\n  }\n\n  stopCamera(): void {\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n      this.stream = null;\n    }\n  }\n\n  toggleTrack(kind: 'audio' | 'video', enabled: boolean): void {\n    if (!this.stream) return;\n\n    const tracks = kind === 'audio'\n      ? this.stream.getAudioTracks()\n      : this.stream.getVideoTracks();\n\n    tracks.forEach(track => {\n      track.enabled = enabled;\n    });\n  }\n\n  async switchCamera(): Promise<MediaStream> {\n    const currentConstraints = this.stream?.getVideoTracks()[0]?.getSettings();\n    const newFacingMode = currentConstraints?.facingMode === 'user' ? 'environment' : 'user';\n\n    this.stopCamera();\n    return this.initializeCamera({ facingMode: newFacingMode });\n  }\n\n  async getAvailableDevices(): Promise<MediaDeviceInfo[]> {\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    return devices.filter(device => device.kind === 'videoinput' || device.kind === 'audioinput');\n  }\n\n  async switchToDevice(deviceId: string, kind: 'audio' | 'video'): Promise<void> {\n    if (!this.stream) return;\n\n    const constraints: MediaStreamConstraints = {};\n\n    if (kind === 'video') {\n      constraints.video = { deviceId: { exact: deviceId } };\n      constraints.audio = true; // Keep existing audio\n    } else {\n      constraints.audio = { deviceId: { exact: deviceId } };\n      constraints.video = true; // Keep existing video\n    }\n\n    const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n    // Replace tracks in existing stream\n    if (kind === 'video') {\n      const videoTrack = newStream.getVideoTracks()[0];\n      const oldVideoTrack = this.stream.getVideoTracks()[0];\n      if (oldVideoTrack) {\n        this.stream.removeTrack(oldVideoTrack);\n        oldVideoTrack.stop();\n      }\n      this.stream.addTrack(videoTrack);\n    } else {\n      const audioTrack = newStream.getAudioTracks()[0];\n      const oldAudioTrack = this.stream.getAudioTracks()[0];\n      if (oldAudioTrack) {\n        this.stream.removeTrack(oldAudioTrack);\n        oldAudioTrack.stop();\n      }\n      this.stream.addTrack(audioTrack);\n    }\n  }\n}\n\nexport function createVideoThumbnail(videoBlob: Blob): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const video = document.createElement('video');\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n\n    if (!ctx) {\n      reject(new Error('Canvas context not available'));\n      return;\n    }\n\n    video.onloadedmetadata = () => {\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n\n      video.currentTime = Math.min(5, video.duration / 2); // Seek to middle or 5 seconds\n    };\n\n    video.onseeked = () => {\n      ctx.drawImage(video, 0, 0);\n      const thumbnail = canvas.toDataURL('image/jpeg', 0.8);\n      resolve(thumbnail);\n\n      // Cleanup\n      video.remove();\n      canvas.remove();\n    };\n\n    video.onerror = () => {\n      reject(new Error('Failed to load video'));\n    };\n\n    video.src = URL.createObjectURL(videoBlob);\n    video.load();\n  });\n}\n\nexport function compressVideo(videoBlob: Blob, quality: 'low' | 'medium' | 'high' = 'medium'): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    const video = document.createElement('video');\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n\n    if (!ctx) {\n      reject(new Error('Canvas context not available'));\n      return;\n    }\n\n    const qualitySettings = {\n      low: { width: 640, height: 360, bitrate: 500000 },\n      medium: { width: 1280, height: 720, bitrate: 1500000 },\n      high: { width: 1920, height: 1080, bitrate: 3000000 }\n    };\n\n    const settings = qualitySettings[quality];\n\n    video.onloadedmetadata = () => {\n      canvas.width = settings.width;\n      canvas.height = settings.height;\n\n      // This is a simplified compression example\n      // In a real application, you'd use WebCodecs API or similar\n      const stream = canvas.captureStream(30);\n      const recorder = new MediaRecorder(stream, {\n        mimeType: 'video/webm;codecs=vp9',\n        videoBitsPerSecond: settings.bitrate\n      });\n\n      const chunks: BlobPart[] = [];\n      recorder.ondataavailable = (event) => {\n        chunks.push(event.data);\n      };\n\n      recorder.onstop = () => {\n        const compressedBlob = new Blob(chunks, { type: 'video/webm' });\n        resolve(compressedBlob);\n      };\n\n      // Start compression process\n      recorder.start();\n\n      // Draw frames (simplified - in reality you'd process the entire video)\n      const drawFrame = () => {\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        if (!video.ended) {\n          requestAnimationFrame(drawFrame);\n        } else {\n          recorder.stop();\n        }\n      };\n\n      video.play();\n      drawFrame();\n    };\n\n    video.src = URL.createObjectURL(videoBlob);\n    video.load();\n  });\n}\n\nexport async function mergeAudioVideo(videoBlob: Blob, _audioBlob: Blob): Promise<Blob> {\n  // This is a complex operation that typically requires server-side processing\n  // or advanced browser APIs like WebCodecs\n  // For now, return the video blob as-is\n  console.warn('Audio-video merging not implemented in browser. Consider server-side processing.');\n  return videoBlob;\n}\n\nexport function downloadBlob(blob: Blob, filename: string): void {\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = filename;\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url);\n}\n\nexport function blobToBase64(blob: Blob): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n      const result = reader.result as string;\n      resolve(result.split(',')[1]); // Remove data:mime;base64, prefix\n    };\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\supabase\\functions\\create-checkout-session\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\supabase\\functions\\platform-upload\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadJob' is defined but never used.","line":120,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":120,"endColumn":41},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3472,3475],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3472,3475],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadJob' is defined but never used.","line":131,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":131,"endColumn":45},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3816,3819],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3816,3819],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadJob' is defined but never used.","line":142,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":142,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4169,4172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4169,4172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadJob' is defined but never used.","line":153,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":153,"endColumn":46},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4519,4522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4519,4522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadJob' is defined but never used.","line":164,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":164,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4873,4876],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4873,4876],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { serve } from 'https://deno.land/std@0.168.0/http/server.ts';\nimport { createClient } from 'npm:@supabase/supabase-js@2';\n\nconst corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n  'Access-Control-Allow-Methods': 'POST, OPTIONS',\n};\n\nserve(async (req) => {\n  if (req.method === 'OPTIONS') {\n    return new Response('ok', { headers: corsHeaders });\n  }\n\n  try {\n    const supabase = createClient(\n      Deno.env.get('SUPABASE_URL') ?? '',\n      Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''\n    );\n\n    const { uploadJobId } = await req.json();\n\n    // Get upload job details\n    const { data: uploadJob, error: jobError } = await supabase\n      .from('upload_jobs')\n      .select(`\n        *,\n        platform:streaming_platforms(*),\n        recording:recordings(*),\n        user_connection:user_platform_connections!inner(*)\n      `)\n      .eq('id', uploadJobId)\n      .single();\n\n    if (jobError || !uploadJob) {\n      throw new Error('Upload job not found');\n    }\n\n    // Update status to processing\n    await supabase\n      .from('upload_jobs')\n      .update({ upload_status: 'processing' })\n      .eq('id', uploadJobId);\n\n    try {\n      // Simulate platform upload based on platform type\n      let uploadResult;\n      \n      switch (uploadJob.platform.name) {\n        case 'spotify':\n          uploadResult = await uploadToSpotify(uploadJob);\n          break;\n        case 'amazon_music':\n          uploadResult = await uploadToAmazonMusic(uploadJob);\n          break;\n        case 'apple_music':\n          uploadResult = await uploadToAppleMusic(uploadJob);\n          break;\n        case 'youtube_music':\n          uploadResult = await uploadToYouTubeMusic(uploadJob);\n          break;\n        case 'deezer':\n          uploadResult = await uploadToDeezer(uploadJob);\n          break;\n        default:\n          throw new Error(`Unsupported platform: ${uploadJob.platform.name}`);\n      }\n\n      // Update job with success\n      await supabase\n        .from('upload_jobs')\n        .update({\n          upload_status: 'completed',\n          platform_track_id: uploadResult.trackId,\n          platform_url: uploadResult.url,\n          cost_used: uploadJob.platform.api_base_cost,\n          completed_at: new Date().toISOString()\n        })\n        .eq('id', uploadJobId);\n\n      // Deduct upload credit\n      await supabase\n        .from('platinum_subscriptions')\n        .update({\n          upload_credits_remaining: uploadJob.user_connection.upload_credits_remaining - 1\n        })\n        .eq('user_id', uploadJob.user_id);\n\n      return new Response(\n        JSON.stringify({ success: true, result: uploadResult }),\n        { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n      );\n\n    } catch (uploadError) {\n      // Update job with failure\n      await supabase\n        .from('upload_jobs')\n        .update({\n          upload_status: 'failed',\n          error_message: uploadError.message\n        })\n        .eq('id', uploadJobId);\n\n      throw uploadError;\n    }\n\n  } catch (error) {\n    console.error('Platform upload error:', error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      {\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        status: 400,\n      }\n    );\n  }\n});\n\n// Platform-specific upload functions (mock implementations)\nasync function uploadToSpotify(uploadJob: any) {\n  // Simulate Spotify API upload\n  await new Promise(resolve => setTimeout(resolve, 2000));\n  \n  return {\n    trackId: `spotify_${Math.random().toString(36).substr(2, 9)}`,\n    url: `https://open.spotify.com/track/${Math.random().toString(36).substr(2, 9)}`,\n    platform: 'spotify'\n  };\n}\n\nasync function uploadToAmazonMusic(uploadJob: any) {\n  // Simulate Amazon Music API upload\n  await new Promise(resolve => setTimeout(resolve, 3000));\n  \n  return {\n    trackId: `amazon_${Math.random().toString(36).substr(2, 9)}`,\n    url: `https://music.amazon.com/tracks/${Math.random().toString(36).substr(2, 9)}`,\n    platform: 'amazon_music'\n  };\n}\n\nasync function uploadToAppleMusic(uploadJob: any) {\n  // Simulate Apple Music API upload\n  await new Promise(resolve => setTimeout(resolve, 2500));\n  \n  return {\n    trackId: `apple_${Math.random().toString(36).substr(2, 9)}`,\n    url: `https://music.apple.com/track/${Math.random().toString(36).substr(2, 9)}`,\n    platform: 'apple_music'\n  };\n}\n\nasync function uploadToYouTubeMusic(uploadJob: any) {\n  // Simulate YouTube Music API upload\n  await new Promise(resolve => setTimeout(resolve, 4000));\n  \n  return {\n    trackId: `youtube_${Math.random().toString(36).substr(2, 9)}`,\n    url: `https://music.youtube.com/watch?v=${Math.random().toString(36).substr(2, 9)}`,\n    platform: 'youtube_music'\n  };\n}\n\nasync function uploadToDeezer(uploadJob: any) {\n  // Simulate Deezer API upload\n  await new Promise(resolve => setTimeout(resolve, 2200));\n  \n  return {\n    trackId: `deezer_${Math.random().toString(36).substr(2, 9)}`,\n    url: `https://www.deezer.com/track/${Math.random().toString(36).substr(2, 9)}`,\n    platform: 'deezer'\n  };\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\supabase\\functions\\spotify-auth\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\supabase\\functions\\spotify-upload\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3087,3090],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3087,3090],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3102,3105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3102,3105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":146,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":146,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4490,4493],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4490,4493],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":173,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5455,5458],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5455,5458],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { serve } from 'https://deno.land/std@0.168.0/http/server.ts';\nimport { createClient } from 'npm:@supabase/supabase-js@2';\n\nconst corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n  'Access-Control-Allow-Methods': 'POST, OPTIONS',\n};\n\nserve(async (req) => {\n  if (req.method === 'OPTIONS') {\n    return new Response('ok', { headers: corsHeaders });\n  }\n\n  try {\n    const supabase = createClient(\n      Deno.env.get('SUPABASE_URL') ?? '',\n      Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''\n    );\n\n    const { uploadJobId } = await req.json();\n\n    // Get upload job with platform connection\n    const { data: uploadJob, error: jobError } = await supabase\n      .from('upload_jobs')\n      .select(`\n        *,\n        platform:streaming_platforms(*),\n        recording:recordings(*),\n        user_connection:user_platform_connections!inner(*)\n      `)\n      .eq('id', uploadJobId)\n      .eq('user_platform_connections.platform_id', 'platform_id')\n      .single();\n\n    if (jobError || !uploadJob) {\n      throw new Error('Upload job not found');\n    }\n\n    // Update status to processing\n    await supabase\n      .from('upload_jobs')\n      .update({ upload_status: 'processing' })\n      .eq('id', uploadJobId);\n\n    try {\n      // Get fresh access token (refresh if needed)\n      const accessToken = await refreshSpotifyToken(uploadJob.user_connection, supabase);\n\n      // Upload to Spotify\n      const uploadResult = await uploadToSpotify(uploadJob, accessToken);\n\n      // Update job with success\n      await supabase\n        .from('upload_jobs')\n        .update({\n          upload_status: 'completed',\n          platform_track_id: uploadResult.trackId,\n          platform_url: uploadResult.url,\n          cost_used: uploadJob.platform.api_base_cost,\n          completed_at: new Date().toISOString(),\n          metadata: { ...uploadJob.metadata, spotify_response: uploadResult }\n        })\n        .eq('id', uploadJobId);\n\n      // Deduct upload credit from Platinum subscription\n      await supabase\n        .from('platinum_subscriptions')\n        .update({\n          upload_credits_remaining: Math.max(0, uploadJob.upload_credits_remaining - 1)\n        })\n        .eq('user_id', uploadJob.user_id);\n\n      return new Response(\n        JSON.stringify({ success: true, result: uploadResult }),\n        { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n      );\n\n    } catch (uploadError) {\n      // Update job with failure\n      await supabase\n        .from('upload_jobs')\n        .update({\n          upload_status: 'failed',\n          error_message: uploadError.message\n        })\n        .eq('id', uploadJobId);\n\n      throw uploadError;\n    }\n\n  } catch (error) {\n    console.error('Spotify upload error:', error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      {\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        status: 400,\n      }\n    );\n  }\n});\n\nasync function refreshSpotifyToken(connection: any, supabase: any) {\n  const now = new Date();\n  const expiresAt = new Date(connection.token_expires_at);\n\n  // If token expires within 5 minutes, refresh it\n  if (expiresAt.getTime() - now.getTime() < 5 * 60 * 1000) {\n    const client_id = Deno.env.get('SPOTIFY_CLIENT_ID') || '';\n    const client_secret = Deno.env.get('SPOTIFY_CLIENT_SECRET') || '';\n\n    const refreshResponse = await fetch('https://accounts.spotify.com/api/token', {\n      method: 'POST',\n      headers: {\n        'Authorization': 'Basic ' + btoa(client_id + ':' + client_secret),\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      body: new URLSearchParams({\n        grant_type: 'refresh_token',\n        refresh_token: connection.refresh_token\n      })\n    });\n\n    if (refreshResponse.ok) {\n      const tokenData = await refreshResponse.json();\n      const newExpiresAt = new Date(Date.now() + (tokenData.expires_in * 1000)).toISOString();\n\n      // Update connection with new token\n      await supabase\n        .from('user_platform_connections')\n        .update({\n          access_token: tokenData.access_token,\n          refresh_token: tokenData.refresh_token || connection.refresh_token,\n          token_expires_at: newExpiresAt\n        })\n        .eq('id', connection.id);\n\n      return tokenData.access_token;\n    }\n  }\n\n  return connection.access_token;\n}\n\nasync function uploadToSpotify(uploadJob: any, accessToken: string) {\n  // Step 1: Create a playlist for the upload (if not exists)\n  const playlistResponse = await fetch('https://api.spotify.com/v1/me/playlists', {\n    method: 'POST',\n    headers: {\n      'Authorization': `Bearer ${accessToken}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      name: 'iTone Karaoke Recordings',\n      description: 'My karaoke recordings from iTone',\n      public: false\n    })\n  });\n\n  let playlistId;\n  if (playlistResponse.ok) {\n    const playlist = await playlistResponse.json();\n    playlistId = playlist.id;\n  } else {\n    // Try to find existing playlist\n    const existingPlaylistsResponse = await fetch('https://api.spotify.com/v1/me/playlists', {\n      headers: { 'Authorization': `Bearer ${accessToken}` }\n    });\n    \n    if (existingPlaylistsResponse.ok) {\n      const playlists = await existingPlaylistsResponse.json();\n      const karaokePlaylist = playlists.items.find((p: any) => p.name === 'iTone Karaoke Recordings');\n      playlistId = karaokePlaylist?.id;\n    }\n  }\n\n  // Note: Spotify doesn't allow direct audio file uploads via API\n  // In a real implementation, this would require Spotify for Podcasters or similar service\n  // For demo purposes, we'll simulate the upload process\n  \n  await new Promise(resolve => setTimeout(resolve, 3000)); // Simulate upload time\n\n  // Generate mock response\n  const trackId = `spotify_${Math.random().toString(36).substr(2, 9)}`;\n  \n  return {\n    trackId: trackId,\n    url: `https://open.spotify.com/track/${trackId}`,\n    playlistId: playlistId,\n    platform: 'spotify',\n    uploadedAt: new Date().toISOString()\n  };\n}","usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\supabase\\functions\\stripe-webhook\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"A:\\ESCRITTORIO\\AI\\Itone\\project-bolt-sb1-9mxnrqyh\\project\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]